output file:
processed_scikit-learnf_regression165.json
function:
f_regression
Error Cases:

Pass or Failed: 0

Related Failed Test Cases:
{'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X2-y2-expected_f_statistic2-expected_p_values2-True]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X5-y5-expected_f_statistic5-expected_p_values5-False]', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X3-y3-expected_f_statistic3-expected_p_values3-True] FAILED', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X6-y6-expected_f_statistic6-expected_p_values6-False] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X1-y1-expected_f_statistic1-expected_p_values1-True]', 'FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X7-y7-expected_f_statistic7-expected_p_values7-False]', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X1-y1-expected_f_statistic1-expected_p_values1-True] FAILED', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X7-y7-expected_f_statistic7-expected_p_values7-False] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X3-y3-expected_f_statistic3-expected_p_values3-True]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X4-y4-expected_f_statistic4-expected_p_values4-False]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X6-y6-expected_f_statistic6-expected_p_values6-False]', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X4-y4-expected_f_statistic4-expected_p_values4-False] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X0-y0-expected_f_statistic0-expected_p_values0-True]', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X2-y2-expected_f_statistic2-expected_p_values2-True] FAILED', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X5-y5-expected_f_statistic5-expected_p_values5-False] FAILED'}

All Test Cases On Generated code:
============================= test session starts ==============================
platform linux -- Python 3.9.0, pytest-8.3.3, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/scikit-learn/scikit-learn/venv/bin/python
cachedir: .pytest_cache
rootdir: /local/data0/moved_data/publishablew/scikit-learn/scikit-learn
configfile: setup.cfg
plugins: cov-6.0.0
collecting ... collected 8 items

../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X0-y0-expected_f_statistic0-expected_p_values0-True] I: Seeding RNGs with 1077778045
FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X1-y1-expected_f_statistic1-expected_p_values1-True] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X2-y2-expected_f_statistic2-expected_p_values2-True] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X3-y3-expected_f_statistic3-expected_p_values3-True] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X4-y4-expected_f_statistic4-expected_p_values4-False] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X5-y5-expected_f_statistic5-expected_p_values5-False] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X6-y6-expected_f_statistic6-expected_p_values6-False] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X7-y7-expected_f_statistic7-expected_p_values7-False] FAILED

=================================== FAILURES ===================================
_ test_f_regression_corner_case[X0-y0-expected_f_statistic0-expected_p_values0-True] _

X = array([[ 2,  1],
       [ 2,  0],
       [ 2, 10],
       [ 2,  4]])
y = array([0, 1, 1, 0]), expected_f_statistic = array([0.       , 0.2293578])
expected_p_values = array([1.        , 0.67924985]), force_finite = True

    @pytest.mark.parametrize(
        "X, y, expected_f_statistic, expected_p_values, force_finite",
        [
            (
                # A feature in X is constant - forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([0.0, 0.2293578]),
                np.array([1.0, 0.67924985]),
                True,
            ),
            (
                # The target y is constant - forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([0.0, 0.0]),
                np.array([1.0, 1.0]),
                True,
            ),
            (
                # Feature in X correlated with y - forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # Feature in X anti-correlated with y - forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # A feature in X is constant - not forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([np.nan, 0.2293578]),
                np.array([np.nan, 0.67924985]),
                False,
            ),
            (
                # The target y is constant - not forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([np.nan, np.nan]),
                np.array([np.nan, np.nan]),
                False,
            ),
            (
                # Feature in X correlated with y - not forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
            (
                # Feature in X anti-correlated with y - not forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
        ],
    )
    def test_f_regression_corner_case(
        X, y, expected_f_statistic, expected_p_values, force_finite
    ):
        """Check the behaviour of `force_finite` for some corner cases with `f_regression`.
    
        Non-regression test for:
        https://github.com/scikit-learn/scikit-learn/issues/15672
        """
        with warnings.catch_warnings():
            warnings.simplefilter("error", RuntimeWarning)
>           f_statistic, p_values = f_regression(X, y, force_finite=force_finite)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py:301: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: in wrapper
    return func(*args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/_univariate_selection.py:322: in f_regression
    return f_regression(X, y)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

X = array([[ 0.  , -2.75],
       [ 0.  , -3.75],
       [ 0.  ,  6.25],
       [ 0.  ,  0.25]])
y = array([-0.5,  0.5,  0.5, -0.5]), center = True, force_finite = True

    def f_regression(X, y, center=True, force_finite=True):
        """
        Perform univariate linear regression tests and return F-statistic and p-values.
    
        Parameters:
        X : array-like or sparse matrix, shape (n_samples, n_features)
            The data matrix.
        y : array-like, shape (n_samples,)
            The target vector.
        center : bool, default=True
            If True, center the data before computing the correlation.
        force_finite : bool, default=True
            If True, replace non-finite F-statistics with a specific value.
    
        Returns:
        f_statistic : ndarray of shape (n_features,)
            The F-statistic for each feature.
        p_values : ndarray of shape (n_features,)
            The p-value for each feature.
        """
        X = check_array(X, accept_sparse=['csr', 'csc', 'coo'])
        y = np.asarray(y)
        if center:
            y = y - np.mean(y)
            X = X - np.mean(X, axis=0)
        corr = np.dot(X.T, y)
>       corr /= np.sqrt(np.sum(X ** 2, axis=0) * np.sum(y ** 2))
E       RuntimeWarning: invalid value encountered in divide

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/temp.py:44: RuntimeWarning
_ test_f_regression_corner_case[X1-y1-expected_f_statistic1-expected_p_values1-True] _

X = array([[ 5,  1],
       [ 3,  0],
       [ 2, 10],
       [ 8,  4]])
y = array([0, 0, 0, 0]), expected_f_statistic = array([0., 0.])
expected_p_values = array([1., 1.]), force_finite = True

    @pytest.mark.parametrize(
        "X, y, expected_f_statistic, expected_p_values, force_finite",
        [
            (
                # A feature in X is constant - forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([0.0, 0.2293578]),
                np.array([1.0, 0.67924985]),
                True,
            ),
            (
                # The target y is constant - forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([0.0, 0.0]),
                np.array([1.0, 1.0]),
                True,
            ),
            (
                # Feature in X correlated with y - forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # Feature in X anti-correlated with y - forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # A feature in X is constant - not forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([np.nan, 0.2293578]),
                np.array([np.nan, 0.67924985]),
                False,
            ),
            (
                # The target y is constant - not forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([np.nan, np.nan]),
                np.array([np.nan, np.nan]),
                False,
            ),
            (
                # Feature in X correlated with y - not forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
            (
                # Feature in X anti-correlated with y - not forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
        ],
    )
    def test_f_regression_corner_case(
        X, y, expected_f_statistic, expected_p_values, force_finite
    ):
        """Check the behaviour of `force_finite` for some corner cases with `f_regression`.
    
        Non-regression test for:
        https://github.com/scikit-learn/scikit-learn/issues/15672
        """
        with warnings.catch_warnings():
            warnings.simplefilter("error", RuntimeWarning)
>           f_statistic, p_values = f_regression(X, y, force_finite=force_finite)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py:301: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: in wrapper
    return func(*args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/_univariate_selection.py:322: in f_regression
    return f_regression(X, y)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

X = array([[ 0.5 , -2.75],
       [-1.5 , -3.75],
       [-2.5 ,  6.25],
       [ 3.5 ,  0.25]])
y = array([0., 0., 0., 0.]), center = True, force_finite = True

    def f_regression(X, y, center=True, force_finite=True):
        """
        Perform univariate linear regression tests and return F-statistic and p-values.
    
        Parameters:
        X : array-like or sparse matrix, shape (n_samples, n_features)
            The data matrix.
        y : array-like, shape (n_samples,)
            The target vector.
        center : bool, default=True
            If True, center the data before computing the correlation.
        force_finite : bool, default=True
            If True, replace non-finite F-statistics with a specific value.
    
        Returns:
        f_statistic : ndarray of shape (n_features,)
            The F-statistic for each feature.
        p_values : ndarray of shape (n_features,)
            The p-value for each feature.
        """
        X = check_array(X, accept_sparse=['csr', 'csc', 'coo'])
        y = np.asarray(y)
        if center:
            y = y - np.mean(y)
            X = X - np.mean(X, axis=0)
        corr = np.dot(X.T, y)
>       corr /= np.sqrt(np.sum(X ** 2, axis=0) * np.sum(y ** 2))
E       RuntimeWarning: invalid value encountered in divide

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/temp.py:44: RuntimeWarning
_ test_f_regression_corner_case[X2-y2-expected_f_statistic2-expected_p_values2-True] _

X = array([[ 0,  1],
       [ 1,  0],
       [ 2, 10],
       [ 3,  4]])
y = array([0, 1, 2, 3])
expected_f_statistic = array([1.79769313e+308, 8.45433000e-001])
expected_p_values = array([0.      , 0.454913]), force_finite = True

    @pytest.mark.parametrize(
        "X, y, expected_f_statistic, expected_p_values, force_finite",
        [
            (
                # A feature in X is constant - forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([0.0, 0.2293578]),
                np.array([1.0, 0.67924985]),
                True,
            ),
            (
                # The target y is constant - forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([0.0, 0.0]),
                np.array([1.0, 1.0]),
                True,
            ),
            (
                # Feature in X correlated with y - forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # Feature in X anti-correlated with y - forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # A feature in X is constant - not forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([np.nan, 0.2293578]),
                np.array([np.nan, 0.67924985]),
                False,
            ),
            (
                # The target y is constant - not forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([np.nan, np.nan]),
                np.array([np.nan, np.nan]),
                False,
            ),
            (
                # Feature in X correlated with y - not forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
            (
                # Feature in X anti-correlated with y - not forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
        ],
    )
    def test_f_regression_corner_case(
        X, y, expected_f_statistic, expected_p_values, force_finite
    ):
        """Check the behaviour of `force_finite` for some corner cases with `f_regression`.
    
        Non-regression test for:
        https://github.com/scikit-learn/scikit-learn/issues/15672
        """
        with warnings.catch_warnings():
            warnings.simplefilter("error", RuntimeWarning)
>           f_statistic, p_values = f_regression(X, y, force_finite=force_finite)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py:301: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: in wrapper
    return func(*args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/_univariate_selection.py:322: in f_regression
    return f_regression(X, y)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

X = array([[-1.5 , -2.75],
       [-0.5 , -3.75],
       [ 0.5 ,  6.25],
       [ 1.5 ,  0.25]])
y = array([-1.5, -0.5,  0.5,  1.5]), center = True, force_finite = True

    def f_regression(X, y, center=True, force_finite=True):
        """
        Perform univariate linear regression tests and return F-statistic and p-values.
    
        Parameters:
        X : array-like or sparse matrix, shape (n_samples, n_features)
            The data matrix.
        y : array-like, shape (n_samples,)
            The target vector.
        center : bool, default=True
            If True, center the data before computing the correlation.
        force_finite : bool, default=True
            If True, replace non-finite F-statistics with a specific value.
    
        Returns:
        f_statistic : ndarray of shape (n_features,)
            The F-statistic for each feature.
        p_values : ndarray of shape (n_features,)
            The p-value for each feature.
        """
        X = check_array(X, accept_sparse=['csr', 'csc', 'coo'])
        y = np.asarray(y)
        if center:
            y = y - np.mean(y)
            X = X - np.mean(X, axis=0)
        corr = np.dot(X.T, y)
        corr /= np.sqrt(np.sum(X ** 2, axis=0) * np.sum(y ** 2))
        n_samples = X.shape[0]
>       f_statistic = corr ** 2 / (1 - corr ** 2) * (n_samples - 2)
E       RuntimeWarning: divide by zero encountered in divide

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/temp.py:46: RuntimeWarning
_ test_f_regression_corner_case[X3-y3-expected_f_statistic3-expected_p_values3-True] _

X = array([[ 3,  1],
       [ 2,  0],
       [ 1, 10],
       [ 0,  4]])
y = array([0, 1, 2, 3])
expected_f_statistic = array([1.79769313e+308, 8.45433000e-001])
expected_p_values = array([0.      , 0.454913]), force_finite = True

    @pytest.mark.parametrize(
        "X, y, expected_f_statistic, expected_p_values, force_finite",
        [
            (
                # A feature in X is constant - forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([0.0, 0.2293578]),
                np.array([1.0, 0.67924985]),
                True,
            ),
            (
                # The target y is constant - forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([0.0, 0.0]),
                np.array([1.0, 1.0]),
                True,
            ),
            (
                # Feature in X correlated with y - forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # Feature in X anti-correlated with y - forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # A feature in X is constant - not forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([np.nan, 0.2293578]),
                np.array([np.nan, 0.67924985]),
                False,
            ),
            (
                # The target y is constant - not forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([np.nan, np.nan]),
                np.array([np.nan, np.nan]),
                False,
            ),
            (
                # Feature in X correlated with y - not forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
            (
                # Feature in X anti-correlated with y - not forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
        ],
    )
    def test_f_regression_corner_case(
        X, y, expected_f_statistic, expected_p_values, force_finite
    ):
        """Check the behaviour of `force_finite` for some corner cases with `f_regression`.
    
        Non-regression test for:
        https://github.com/scikit-learn/scikit-learn/issues/15672
        """
        with warnings.catch_warnings():
            warnings.simplefilter("error", RuntimeWarning)
>           f_statistic, p_values = f_regression(X, y, force_finite=force_finite)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py:301: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: in wrapper
    return func(*args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/_univariate_selection.py:322: in f_regression
    return f_regression(X, y)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

X = array([[ 1.5 , -2.75],
       [ 0.5 , -3.75],
       [-0.5 ,  6.25],
       [-1.5 ,  0.25]])
y = array([-1.5, -0.5,  0.5,  1.5]), center = True, force_finite = True

    def f_regression(X, y, center=True, force_finite=True):
        """
        Perform univariate linear regression tests and return F-statistic and p-values.
    
        Parameters:
        X : array-like or sparse matrix, shape (n_samples, n_features)
            The data matrix.
        y : array-like, shape (n_samples,)
            The target vector.
        center : bool, default=True
            If True, center the data before computing the correlation.
        force_finite : bool, default=True
            If True, replace non-finite F-statistics with a specific value.
    
        Returns:
        f_statistic : ndarray of shape (n_features,)
            The F-statistic for each feature.
        p_values : ndarray of shape (n_features,)
            The p-value for each feature.
        """
        X = check_array(X, accept_sparse=['csr', 'csc', 'coo'])
        y = np.asarray(y)
        if center:
            y = y - np.mean(y)
            X = X - np.mean(X, axis=0)
        corr = np.dot(X.T, y)
        corr /= np.sqrt(np.sum(X ** 2, axis=0) * np.sum(y ** 2))
        n_samples = X.shape[0]
>       f_statistic = corr ** 2 / (1 - corr ** 2) * (n_samples - 2)
E       RuntimeWarning: divide by zero encountered in divide

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/temp.py:46: RuntimeWarning
_ test_f_regression_corner_case[X4-y4-expected_f_statistic4-expected_p_values4-False] _

X = array([[ 2,  1],
       [ 2,  0],
       [ 2, 10],
       [ 2,  4]])
y = array([0, 1, 1, 0]), expected_f_statistic = array([      nan, 0.2293578])
expected_p_values = array([       nan, 0.67924985]), force_finite = False

    @pytest.mark.parametrize(
        "X, y, expected_f_statistic, expected_p_values, force_finite",
        [
            (
                # A feature in X is constant - forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([0.0, 0.2293578]),
                np.array([1.0, 0.67924985]),
                True,
            ),
            (
                # The target y is constant - forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([0.0, 0.0]),
                np.array([1.0, 1.0]),
                True,
            ),
            (
                # Feature in X correlated with y - forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # Feature in X anti-correlated with y - forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # A feature in X is constant - not forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([np.nan, 0.2293578]),
                np.array([np.nan, 0.67924985]),
                False,
            ),
            (
                # The target y is constant - not forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([np.nan, np.nan]),
                np.array([np.nan, np.nan]),
                False,
            ),
            (
                # Feature in X correlated with y - not forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
            (
                # Feature in X anti-correlated with y - not forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
        ],
    )
    def test_f_regression_corner_case(
        X, y, expected_f_statistic, expected_p_values, force_finite
    ):
        """Check the behaviour of `force_finite` for some corner cases with `f_regression`.
    
        Non-regression test for:
        https://github.com/scikit-learn/scikit-learn/issues/15672
        """
        with warnings.catch_warnings():
            warnings.simplefilter("error", RuntimeWarning)
>           f_statistic, p_values = f_regression(X, y, force_finite=force_finite)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py:301: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: in wrapper
    return func(*args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/_univariate_selection.py:322: in f_regression
    return f_regression(X, y)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

X = array([[ 0.  , -2.75],
       [ 0.  , -3.75],
       [ 0.  ,  6.25],
       [ 0.  ,  0.25]])
y = array([-0.5,  0.5,  0.5, -0.5]), center = True, force_finite = True

    def f_regression(X, y, center=True, force_finite=True):
        """
        Perform univariate linear regression tests and return F-statistic and p-values.
    
        Parameters:
        X : array-like or sparse matrix, shape (n_samples, n_features)
            The data matrix.
        y : array-like, shape (n_samples,)
            The target vector.
        center : bool, default=True
            If True, center the data before computing the correlation.
        force_finite : bool, default=True
            If True, replace non-finite F-statistics with a specific value.
    
        Returns:
        f_statistic : ndarray of shape (n_features,)
            The F-statistic for each feature.
        p_values : ndarray of shape (n_features,)
            The p-value for each feature.
        """
        X = check_array(X, accept_sparse=['csr', 'csc', 'coo'])
        y = np.asarray(y)
        if center:
            y = y - np.mean(y)
            X = X - np.mean(X, axis=0)
        corr = np.dot(X.T, y)
>       corr /= np.sqrt(np.sum(X ** 2, axis=0) * np.sum(y ** 2))
E       RuntimeWarning: invalid value encountered in divide

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/temp.py:44: RuntimeWarning
_ test_f_regression_corner_case[X5-y5-expected_f_statistic5-expected_p_values5-False] _

X = array([[ 5,  1],
       [ 3,  0],
       [ 2, 10],
       [ 8,  4]])
y = array([0, 0, 0, 0]), expected_f_statistic = array([nan, nan])
expected_p_values = array([nan, nan]), force_finite = False

    @pytest.mark.parametrize(
        "X, y, expected_f_statistic, expected_p_values, force_finite",
        [
            (
                # A feature in X is constant - forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([0.0, 0.2293578]),
                np.array([1.0, 0.67924985]),
                True,
            ),
            (
                # The target y is constant - forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([0.0, 0.0]),
                np.array([1.0, 1.0]),
                True,
            ),
            (
                # Feature in X correlated with y - forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # Feature in X anti-correlated with y - forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # A feature in X is constant - not forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([np.nan, 0.2293578]),
                np.array([np.nan, 0.67924985]),
                False,
            ),
            (
                # The target y is constant - not forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([np.nan, np.nan]),
                np.array([np.nan, np.nan]),
                False,
            ),
            (
                # Feature in X correlated with y - not forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
            (
                # Feature in X anti-correlated with y - not forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
        ],
    )
    def test_f_regression_corner_case(
        X, y, expected_f_statistic, expected_p_values, force_finite
    ):
        """Check the behaviour of `force_finite` for some corner cases with `f_regression`.
    
        Non-regression test for:
        https://github.com/scikit-learn/scikit-learn/issues/15672
        """
        with warnings.catch_warnings():
            warnings.simplefilter("error", RuntimeWarning)
>           f_statistic, p_values = f_regression(X, y, force_finite=force_finite)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py:301: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: in wrapper
    return func(*args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/_univariate_selection.py:322: in f_regression
    return f_regression(X, y)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

X = array([[ 0.5 , -2.75],
       [-1.5 , -3.75],
       [-2.5 ,  6.25],
       [ 3.5 ,  0.25]])
y = array([0., 0., 0., 0.]), center = True, force_finite = True

    def f_regression(X, y, center=True, force_finite=True):
        """
        Perform univariate linear regression tests and return F-statistic and p-values.
    
        Parameters:
        X : array-like or sparse matrix, shape (n_samples, n_features)
            The data matrix.
        y : array-like, shape (n_samples,)
            The target vector.
        center : bool, default=True
            If True, center the data before computing the correlation.
        force_finite : bool, default=True
            If True, replace non-finite F-statistics with a specific value.
    
        Returns:
        f_statistic : ndarray of shape (n_features,)
            The F-statistic for each feature.
        p_values : ndarray of shape (n_features,)
            The p-value for each feature.
        """
        X = check_array(X, accept_sparse=['csr', 'csc', 'coo'])
        y = np.asarray(y)
        if center:
            y = y - np.mean(y)
            X = X - np.mean(X, axis=0)
        corr = np.dot(X.T, y)
>       corr /= np.sqrt(np.sum(X ** 2, axis=0) * np.sum(y ** 2))
E       RuntimeWarning: invalid value encountered in divide

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/temp.py:44: RuntimeWarning
_ test_f_regression_corner_case[X6-y6-expected_f_statistic6-expected_p_values6-False] _

X = array([[ 0,  1],
       [ 1,  0],
       [ 2, 10],
       [ 3,  4]])
y = array([0, 1, 2, 3]), expected_f_statistic = array([     inf, 0.845433])
expected_p_values = array([0.      , 0.454913]), force_finite = False

    @pytest.mark.parametrize(
        "X, y, expected_f_statistic, expected_p_values, force_finite",
        [
            (
                # A feature in X is constant - forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([0.0, 0.2293578]),
                np.array([1.0, 0.67924985]),
                True,
            ),
            (
                # The target y is constant - forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([0.0, 0.0]),
                np.array([1.0, 1.0]),
                True,
            ),
            (
                # Feature in X correlated with y - forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # Feature in X anti-correlated with y - forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # A feature in X is constant - not forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([np.nan, 0.2293578]),
                np.array([np.nan, 0.67924985]),
                False,
            ),
            (
                # The target y is constant - not forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([np.nan, np.nan]),
                np.array([np.nan, np.nan]),
                False,
            ),
            (
                # Feature in X correlated with y - not forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
            (
                # Feature in X anti-correlated with y - not forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
        ],
    )
    def test_f_regression_corner_case(
        X, y, expected_f_statistic, expected_p_values, force_finite
    ):
        """Check the behaviour of `force_finite` for some corner cases with `f_regression`.
    
        Non-regression test for:
        https://github.com/scikit-learn/scikit-learn/issues/15672
        """
        with warnings.catch_warnings():
            warnings.simplefilter("error", RuntimeWarning)
>           f_statistic, p_values = f_regression(X, y, force_finite=force_finite)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py:301: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: in wrapper
    return func(*args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/_univariate_selection.py:322: in f_regression
    return f_regression(X, y)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

X = array([[-1.5 , -2.75],
       [-0.5 , -3.75],
       [ 0.5 ,  6.25],
       [ 1.5 ,  0.25]])
y = array([-1.5, -0.5,  0.5,  1.5]), center = True, force_finite = True

    def f_regression(X, y, center=True, force_finite=True):
        """
        Perform univariate linear regression tests and return F-statistic and p-values.
    
        Parameters:
        X : array-like or sparse matrix, shape (n_samples, n_features)
            The data matrix.
        y : array-like, shape (n_samples,)
            The target vector.
        center : bool, default=True
            If True, center the data before computing the correlation.
        force_finite : bool, default=True
            If True, replace non-finite F-statistics with a specific value.
    
        Returns:
        f_statistic : ndarray of shape (n_features,)
            The F-statistic for each feature.
        p_values : ndarray of shape (n_features,)
            The p-value for each feature.
        """
        X = check_array(X, accept_sparse=['csr', 'csc', 'coo'])
        y = np.asarray(y)
        if center:
            y = y - np.mean(y)
            X = X - np.mean(X, axis=0)
        corr = np.dot(X.T, y)
        corr /= np.sqrt(np.sum(X ** 2, axis=0) * np.sum(y ** 2))
        n_samples = X.shape[0]
>       f_statistic = corr ** 2 / (1 - corr ** 2) * (n_samples - 2)
E       RuntimeWarning: divide by zero encountered in divide

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/temp.py:46: RuntimeWarning
_ test_f_regression_corner_case[X7-y7-expected_f_statistic7-expected_p_values7-False] _

X = array([[ 3,  1],
       [ 2,  0],
       [ 1, 10],
       [ 0,  4]])
y = array([0, 1, 2, 3]), expected_f_statistic = array([     inf, 0.845433])
expected_p_values = array([0.      , 0.454913]), force_finite = False

    @pytest.mark.parametrize(
        "X, y, expected_f_statistic, expected_p_values, force_finite",
        [
            (
                # A feature in X is constant - forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([0.0, 0.2293578]),
                np.array([1.0, 0.67924985]),
                True,
            ),
            (
                # The target y is constant - forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([0.0, 0.0]),
                np.array([1.0, 1.0]),
                True,
            ),
            (
                # Feature in X correlated with y - forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # Feature in X anti-correlated with y - forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.finfo(np.float64).max, 0.845433]),
                np.array([0.0, 0.454913]),
                True,
            ),
            (
                # A feature in X is constant - not forcing finite
                np.array([[2, 1], [2, 0], [2, 10], [2, 4]]),
                np.array([0, 1, 1, 0]),
                np.array([np.nan, 0.2293578]),
                np.array([np.nan, 0.67924985]),
                False,
            ),
            (
                # The target y is constant - not forcing finite
                np.array([[5, 1], [3, 0], [2, 10], [8, 4]]),
                np.array([0, 0, 0, 0]),
                np.array([np.nan, np.nan]),
                np.array([np.nan, np.nan]),
                False,
            ),
            (
                # Feature in X correlated with y - not forcing finite
                np.array([[0, 1], [1, 0], [2, 10], [3, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
            (
                # Feature in X anti-correlated with y - not forcing finite
                np.array([[3, 1], [2, 0], [1, 10], [0, 4]]),
                np.array([0, 1, 2, 3]),
                np.array([np.inf, 0.845433]),
                np.array([0.0, 0.454913]),
                False,
            ),
        ],
    )
    def test_f_regression_corner_case(
        X, y, expected_f_statistic, expected_p_values, force_finite
    ):
        """Check the behaviour of `force_finite` for some corner cases with `f_regression`.
    
        Non-regression test for:
        https://github.com/scikit-learn/scikit-learn/issues/15672
        """
        with warnings.catch_warnings():
            warnings.simplefilter("error", RuntimeWarning)
>           f_statistic, p_values = f_regression(X, y, force_finite=force_finite)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py:301: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: in wrapper
    return func(*args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/_univariate_selection.py:322: in f_regression
    return f_regression(X, y)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

X = array([[ 1.5 , -2.75],
       [ 0.5 , -3.75],
       [-0.5 ,  6.25],
       [-1.5 ,  0.25]])
y = array([-1.5, -0.5,  0.5,  1.5]), center = True, force_finite = True

    def f_regression(X, y, center=True, force_finite=True):
        """
        Perform univariate linear regression tests and return F-statistic and p-values.
    
        Parameters:
        X : array-like or sparse matrix, shape (n_samples, n_features)
            The data matrix.
        y : array-like, shape (n_samples,)
            The target vector.
        center : bool, default=True
            If True, center the data before computing the correlation.
        force_finite : bool, default=True
            If True, replace non-finite F-statistics with a specific value.
    
        Returns:
        f_statistic : ndarray of shape (n_features,)
            The F-statistic for each feature.
        p_values : ndarray of shape (n_features,)
            The p-value for each feature.
        """
        X = check_array(X, accept_sparse=['csr', 'csc', 'coo'])
        y = np.asarray(y)
        if center:
            y = y - np.mean(y)
            X = X - np.mean(X, axis=0)
        corr = np.dot(X.T, y)
        corr /= np.sqrt(np.sum(X ** 2, axis=0) * np.sum(y ** 2))
        n_samples = X.shape[0]
>       f_statistic = corr ** 2 / (1 - corr ** 2) * (n_samples - 2)
E       RuntimeWarning: divide by zero encountered in divide

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/temp.py:46: RuntimeWarning
=========================== short test summary info ============================
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X0-y0-expected_f_statistic0-expected_p_values0-True]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X1-y1-expected_f_statistic1-expected_p_values1-True]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X2-y2-expected_f_statistic2-expected_p_values2-True]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X3-y3-expected_f_statistic3-expected_p_values3-True]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X4-y4-expected_f_statistic4-expected_p_values4-False]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X5-y5-expected_f_statistic5-expected_p_values5-False]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X6-y6-expected_f_statistic6-expected_p_values6-False]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X7-y7-expected_f_statistic7-expected_p_values7-False]
============================== 8 failed in 0.53s ===============================


Final Test Result:
============================= test session starts ==============================
platform linux -- Python 3.9.0, pytest-8.3.3, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/scikit-learn/scikit-learn/venv/bin/python
cachedir: .pytest_cache
rootdir: /local/data0/moved_data/publishablew/scikit-learn/scikit-learn
configfile: setup.cfg
plugins: cov-6.0.0
collecting ... collected 8 items

../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X0-y0-expected_f_statistic0-expected_p_values0-True] I: Seeding RNGs with 1837846188
PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X1-y1-expected_f_statistic1-expected_p_values1-True] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X2-y2-expected_f_statistic2-expected_p_values2-True] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X3-y3-expected_f_statistic3-expected_p_values3-True] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X4-y4-expected_f_statistic4-expected_p_values4-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X5-y5-expected_f_statistic5-expected_p_values5-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X6-y6-expected_f_statistic6-expected_p_values6-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X7-y7-expected_f_statistic7-expected_p_values7-False] PASSED

============================== 8 passed in 0.26s ===============================


Initial Result:
============================= test session starts ==============================
platform linux -- Python 3.9.0, pytest-8.3.3, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/scikit-learn/scikit-learn/venv/bin/python
cachedir: .pytest_cache
rootdir: /local/data0/moved_data/publishablew/scikit-learn/scikit-learn
configfile: setup.cfg
plugins: cov-6.0.0
collecting ... collected 8 items

../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X0-y0-expected_f_statistic0-expected_p_values0-True] I: Seeding RNGs with 1498766830
PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X1-y1-expected_f_statistic1-expected_p_values1-True] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X2-y2-expected_f_statistic2-expected_p_values2-True] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X3-y3-expected_f_statistic3-expected_p_values3-True] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X4-y4-expected_f_statistic4-expected_p_values4-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X5-y5-expected_f_statistic5-expected_p_values5-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X6-y6-expected_f_statistic6-expected_p_values6-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/feature_selection/tests/test_feature_select.py::test_f_regression_corner_case[X7-y7-expected_f_statistic7-expected_p_values7-False] PASSED

============================== 8 passed in 0.26s ===============================
