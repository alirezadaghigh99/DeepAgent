output file:
processed_GPflowndiagquad39.json
function:
ndiagquad
Error Cases:
2025-02-14 03:39:26.549363: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1739522366.560686 2189173 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1739522366.564335 2189173 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-02-14 03:39:26.577289: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
I0000 00:00:1739522369.079371 2189173 gpu_device.cc:2022] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9446 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3060, pci bus id: 0000:06:00.0, compute capability: 8.6
2025-02-14 03:39:29.299190: W tensorflow/core/framework/op_kernel.cc:1829] INVALID_ARGUMENT: required broadcastable shapes
2025-02-14 03:39:29.299214: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: INVALID_ARGUMENT: required broadcastable shapes
2025-02-14 03:39:39.606091: W external/local_xla/xla/tsl/framework/bfc_allocator.cc:497] Allocator (GPU_0_bfc) ran out of memory trying to allocate 256.00GiB (rounded to 274877906944)requested by op Fill
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2025-02-14 03:39:39.606139: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1053] BFCAllocator dump for GPU_0_bfc
2025-02-14 03:39:39.606155: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (256): 	Total Chunks: 7, Chunks in use: 7. 1.8KiB allocated for chunks. 1.8KiB in use in bin. 280B client-requested in use in bin.
2025-02-14 03:39:39.606166: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606177: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2025-02-14 03:39:39.606186: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606195: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606206: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606215: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606230: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606239: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606249: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606258: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606268: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606277: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606287: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606296: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606306: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606315: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606325: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606334: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606344: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606354: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (268435456): 	Total Chunks: 1, Chunks in use: 0. 9.22GiB allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:39.606365: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1076] Bin for 256.00GiB was 256.00MiB, Chunk State: 
2025-02-14 03:39:39.606380: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1082]   Size: 9.22GiB | Requested Size: 8B | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 16B | in_use: 1 | bin_num: -1
2025-02-14 03:39:39.606389: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1089] Next region of size 9905569792
2025-02-14 03:39:39.606402: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000000 of size 256 next 1
2025-02-14 03:39:39.606412: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000100 of size 1280 next 2
2025-02-14 03:39:39.606421: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000600 of size 256 next 3
2025-02-14 03:39:39.606428: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000700 of size 256 next 4
2025-02-14 03:39:39.606433: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000800 of size 256 next 5
2025-02-14 03:39:39.606439: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000900 of size 256 next 6
2025-02-14 03:39:39.606444: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000a00 of size 256 next 7
2025-02-14 03:39:39.606449: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000b00 of size 256 next 8
2025-02-14 03:39:39.606455: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] Free  at 7c4d76000c00 of size 9905566720 next 18446744073709551615
2025-02-14 03:39:39.606461: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1114]      Summary of in-use Chunks by size: 
2025-02-14 03:39:39.606468: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1117] 7 Chunks of size 256 totalling 1.8KiB
2025-02-14 03:39:39.606474: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1117] 1 Chunks of size 1280 totalling 1.2KiB
2025-02-14 03:39:39.606480: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1121] Sum Total of in-use chunks: 3.0KiB
2025-02-14 03:39:39.606486: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1123] Total bytes in pool: 9905569792 memory_limit_: 9905569792 available bytes: 0 curr_region_allocation_bytes_: 19811139584
2025-02-14 03:39:39.606494: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1128] Stats: 
Limit:                      9905569792
InUse:                            3072
MaxInUse:                         9216
NumAllocs:                          67
MaxAllocSize:                     1280
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2025-02-14 03:39:39.606500: W external/local_xla/xla/tsl/framework/bfc_allocator.cc:508] *___________________________________________________________________________________________________
2025-02-14 03:39:39.606520: W tensorflow/core/framework/op_kernel.cc:1841] OP_REQUIRES failed at constant_op.cc:176 : RESOURCE_EXHAUSTED: OOM when allocating tensor with shape[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2] and type double on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
2025-02-14 03:39:39.606533: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: RESOURCE_EXHAUSTED: OOM when allocating tensor with shape[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2] and type double on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
2025-02-14 03:39:49.626443: W external/local_xla/xla/tsl/framework/bfc_allocator.cc:497] Allocator (GPU_0_bfc) ran out of memory trying to allocate 6.25GiB (rounded to 6710886400)requested by op Pack
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation. 
Current allocation summary follows.
Current allocation summary follows.
2025-02-14 03:39:49.626492: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1053] BFCAllocator dump for GPU_0_bfc
2025-02-14 03:39:49.626507: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (256): 	Total Chunks: 9, Chunks in use: 9. 2.2KiB allocated for chunks. 2.2KiB in use in bin. 312B client-requested in use in bin.
2025-02-14 03:39:49.626518: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626529: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2025-02-14 03:39:49.626538: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626547: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626556: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626565: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626574: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626584: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626593: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (131072): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626603: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626612: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626622: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626631: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626641: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (4194304): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626651: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626661: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626670: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626680: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626689: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2025-02-14 03:39:49.626700: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1060] Bin (268435456): 	Total Chunks: 27, Chunks in use: 25. 9.22GiB allocated for chunks. 6.25GiB in use in bin. 6.25GiB client-requested in use in bin.
2025-02-14 03:39:49.626713: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1076] Bin for 6.25GiB was 256.00MiB, Chunk State: 
2025-02-14 03:39:49.626729: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1082]   Size: 256.00MiB | Requested Size: 256.00MiB | in_use: 0 | bin_num: 20, prev:   Size: 256B | Requested Size: 16B | in_use: 1 | bin_num: -1, next:   Size: 256.00MiB | Requested Size: 256.00MiB | in_use: 1 | bin_num: -1
2025-02-14 03:39:49.626741: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1082]   Size: 2.72GiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 256.00MiB | Requested Size: 256.00MiB | in_use: 1 | bin_num: -1
2025-02-14 03:39:49.626749: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1089] Next region of size 9905569792
2025-02-14 03:39:49.626760: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000000 of size 256 next 1
2025-02-14 03:39:49.626768: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000100 of size 1280 next 2
2025-02-14 03:39:49.626774: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000600 of size 256 next 3
2025-02-14 03:39:49.626781: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000700 of size 256 next 4
2025-02-14 03:39:49.626788: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000800 of size 256 next 5
2025-02-14 03:39:49.626795: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000900 of size 256 next 6
2025-02-14 03:39:49.626802: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000a00 of size 256 next 7
2025-02-14 03:39:49.626809: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000b00 of size 256 next 8
2025-02-14 03:39:49.626815: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000c00 of size 256 next 9
2025-02-14 03:39:49.626822: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d76000d00 of size 256 next 10
2025-02-14 03:39:49.626829: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] Free  at 7c4d76000e00 of size 268435456 next 11
2025-02-14 03:39:49.626836: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d86000e00 of size 268435456 next 12
2025-02-14 03:39:49.626845: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4d96000e00 of size 268435456 next 13
2025-02-14 03:39:49.626852: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4da6000e00 of size 268435456 next 14
2025-02-14 03:39:49.626859: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4db6000e00 of size 268435456 next 15
2025-02-14 03:39:49.626868: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4dc6000e00 of size 268435456 next 16
2025-02-14 03:39:49.626876: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4dd6000e00 of size 268435456 next 17
2025-02-14 03:39:49.626883: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4de6000e00 of size 268435456 next 18
2025-02-14 03:39:49.626889: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4df6000e00 of size 268435456 next 19
2025-02-14 03:39:49.626896: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4e06000e00 of size 268435456 next 20
2025-02-14 03:39:49.626903: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4e16000e00 of size 268435456 next 21
2025-02-14 03:39:49.626910: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4e26000e00 of size 268435456 next 22
2025-02-14 03:39:49.626916: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4e36000e00 of size 268435456 next 23
2025-02-14 03:39:49.626923: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4e46000e00 of size 268435456 next 24
2025-02-14 03:39:49.626930: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4e56000e00 of size 268435456 next 25
2025-02-14 03:39:49.626937: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4e66000e00 of size 268435456 next 26
2025-02-14 03:39:49.626960: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4e76000e00 of size 268435456 next 27
2025-02-14 03:39:49.626967: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4e86000e00 of size 268435456 next 28
2025-02-14 03:39:49.626974: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4e96000e00 of size 268435456 next 29
2025-02-14 03:39:49.626981: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4ea6000e00 of size 268435456 next 30
2025-02-14 03:39:49.626988: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4eb6000e00 of size 268435456 next 31
2025-02-14 03:39:49.626994: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4ec6000e00 of size 268435456 next 32
2025-02-14 03:39:49.627003: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4ed6000e00 of size 268435456 next 33
2025-02-14 03:39:49.627010: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4ee6000e00 of size 268435456 next 34
2025-02-14 03:39:49.627017: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4ef6000e00 of size 268435456 next 35
2025-02-14 03:39:49.627023: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] InUse at 7c4f06000e00 of size 268435456 next 36
2025-02-14 03:39:49.627030: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1109] Free  at 7c4f16000e00 of size 2926244352 next 18446744073709551615
2025-02-14 03:39:49.627037: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1114]      Summary of in-use Chunks by size: 
2025-02-14 03:39:49.627045: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1117] 9 Chunks of size 256 totalling 2.2KiB
2025-02-14 03:39:49.627053: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1117] 1 Chunks of size 1280 totalling 1.2KiB
2025-02-14 03:39:49.627060: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1117] 25 Chunks of size 268435456 totalling 6.25GiB
2025-02-14 03:39:49.627067: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1121] Sum Total of in-use chunks: 6.25GiB
2025-02-14 03:39:49.627078: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1123] Total bytes in pool: 9905569792 memory_limit_: 9905569792 available bytes: 0 curr_region_allocation_bytes_: 19811139584
2025-02-14 03:39:49.627093: I external/local_xla/xla/tsl/framework/bfc_allocator.cc:1128] Stats: 
Limit:                      9905569792
InUse:                      6710889984
MaxInUse:                   6979325440
NumAllocs:                          95
MaxAllocSize:                268435456
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2025-02-14 03:39:49.627103: W external/local_xla/xla/tsl/framework/bfc_allocator.cc:508] *_*********************************************************************_____________________________
2025-02-14 03:39:49.627123: W tensorflow/core/framework/op_kernel.cc:1841] OP_REQUIRES failed at pack_op.cc:81 : RESOURCE_EXHAUSTED: OOM when allocating tensor with shape[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,25] and type double on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
2025-02-14 03:39:49.792237: W tensorflow/core/framework/op_kernel.cc:1829] INVALID_ARGUMENT: required broadcastable shapes
2025-02-14 03:39:49.792258: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: INVALID_ARGUMENT: required broadcastable shapes

Pass or Failed: 0

Related Failed Test Cases:
{'../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_quadrature_autograph FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_2d[var20-mu20-var10-mu10]', '../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_with_kwarg[var10-mu10] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_logspace[var20-mu20-var10-mu10]', '../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_ndiagquad_does_not_throw_error FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_ndiagquad_does_not_throw_error', 'FAILED ../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_with_kwarg[var10-mu10]', '../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_logspace[var20-mu20-var10-mu10] FAILED', '../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_1d[var0-mu0] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_1d[var0-mu0]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_quadrature_autograph', '../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_2d[var20-mu20-var10-mu10] FAILED'}

All Test Cases On Generated code:
============================= test session starts ==============================
platform linux -- Python 3.11.10, pytest-8.3.4, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/GPflow/GPflow/venv/bin/python
cachedir: .pytest_cache
rootdir: /local/data0/moved_data/publishablew/GPflow/GPflow
collecting ... collected 6 items

../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_1d[var0-mu0] FAILED
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_2d[var20-mu20-var10-mu10] FAILED
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_logspace[var20-mu20-var10-mu10] FAILED
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_with_kwarg[var10-mu10] FAILED
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_ndiagquad_does_not_throw_error FAILED
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_quadrature_autograph FAILED

=================================== FAILURES ===================================
__________________________ test_diagquad_1d[var0-mu0] __________________________

mu = array([1. , 1.3]), var = array([3. , 3.5])

    @pytest.mark.parametrize("mu", [np.array([1.0, 1.3])])
    @pytest.mark.parametrize("var", [np.array([3.0, 3.5])])
    def test_diagquad_1d(mu: TensorType, var: TensorType) -> None:
        num_gauss_hermite_points = 25
>       quad = quadrature.ndiagquad([lambda *X: tf.exp(X[0])], num_gauss_hermite_points, [mu], [var])

/local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py:30: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/deprecated.py:72: in ndiagquad
    return ndiagquad(funcs, H, Fmu, Fvar, logspace)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/temp.py:34: in ndiagquad
    result = quadrature(integrand, Fmu, Fvar)
/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/check_shapes/integration/tf.py:76: in wrapped_method
    return wrapped_function(self, *args, **kwargs)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/base.py:80: in __call__
    X, W = self._build_X_W(mean, var)
/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/check_shapes/integration/tf.py:76: in wrapped_method
    return wrapped_function(self, *args, **kwargs)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/gauss_hermite.py:149: in _build_X_W
    X = mean + stddev * Z
/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow/python/util/traceback_utils.py:153: in error_handler
    raise e.with_traceback(filtered_tb) from None
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

e = _NotOkStatusException(), name = None

    def raise_from_not_ok_status(e, name) -> NoReturn:
      e.message += (" name: " + str(name if name is not None else ""))
>     raise core._status_to_exception(e) from None  # pylint: disable=protected-access
E     tensorflow.python.framework.errors_impl.InvalidArgumentError: {{function_node __wrapped__Mul_device_/job:localhost/replica:0/task:0/device:GPU:0}} required broadcastable shapes [Op:Mul] name:

/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow/python/framework/ops.py:6002: InvalidArgumentError
___________________ test_diagquad_2d[var20-mu20-var10-mu10] ____________________

mu1 = array([1. , 1.3]), var1 = array([3. , 3.5]), mu2 = array([-2. ,  0.3])
var2 = array([4. , 4.2])

    @pytest.mark.parametrize("mu1", [np.array([1.0, 1.3])])
    @pytest.mark.parametrize("var1", [np.array([3.0, 3.5])])
    @pytest.mark.parametrize("mu2", [np.array([-2.0, 0.3])])
    @pytest.mark.parametrize("var2", [np.array([4.0, 4.2])])
    def test_diagquad_2d(mu1: TensorType, var1: TensorType, mu2: TensorType, var2: TensorType) -> None:
        alpha = 2.5
        # using logspace=True we can reduce this, see test_diagquad_logspace
        num_gauss_hermite_points = 35
>       quad = quadrature.ndiagquad(
            lambda *X: tf.exp(X[0] + alpha * X[1]),
            num_gauss_hermite_points,
            [mu1, mu2],
            [var1, var2],
        )

/local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py:43: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/deprecated.py:72: in ndiagquad
    return ndiagquad(funcs, H, Fmu, Fvar, logspace)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/temp.py:26: in ndiagquad
    quadrature = NDiagGHQuadrature(H, len(Fmu))
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/gauss_hermite.py:121: in __init__
    Z, dZ = ndgh_points_and_weights(self.dim, self.n_gh)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/gauss_hermite.py:109: in ndgh_points_and_weights
    return reshape_Z_dZ(zs, dzs)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/gauss_hermite.py:77: in reshape_Z_dZ
    Z = list_to_flat_grid(zs)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/gauss_hermite.py:59: in list_to_flat_grid
    return tf.reshape(tf.stack(tf.meshgrid(*xs), axis=-1), (-1, len(xs)))
/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow/python/util/traceback_utils.py:153: in error_handler
    raise e.with_traceback(filtered_tb) from None
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

fn = <function fill at 0x7c51841f8720>, layout = None, args = ()
kwargs = {'dims': <tf.Tensor: shape=(35,), dtype=int32, numpy=
array([2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, ..., 2, 2, 2, 2, 2, 2, 2, 2, 2, 2], dtype=int32)>, 'name': None, 'value': <tf.Tensor: shape=(), dtype=float64, numpy=1.0>}

    @tf_export("experimental.dtensor.call_with_layout", v1=[])
    def call_with_layout(fn: Callable[...,
                                      Any], layout: Optional[layout_lib.Layout],
                         *args, **kwargs) -> Any:
      """Calls a function in the DTensor device scope if `layout` is not None.
    
      If `layout` is not None, `fn` consumes DTensor(s) as input and produces a
      DTensor as output; a DTensor is a tf.Tensor with layout-related attributes.
    
      If `layout` is None, `fn` consumes and produces regular tf.Tensors.
    
      Args:
        fn: A supported TF API function such as tf.zeros.
        layout: Optional, the layout of the output DTensor.
        *args:  Arguments given to `fn`.
        **kwargs: Keyword arguments given to `fn`.
    
      Returns:
        The return value of `fn` transformed to a DTensor if requested.
      """
      if layout is not None:
        if context.executing_eagerly():
          with default_mesh(layout.mesh):
            with _dtensor_device()._default_layout(layout):  # pylint: disable=protected-access
              return fn(*args, **kwargs)
        else:
          return relayout(fn(*args, **kwargs), layout)
>     return fn(*args, **kwargs)
E     tensorflow.python.framework.errors_impl.ResourceExhaustedError: {{function_node __wrapped__Fill_device_/job:localhost/replica:0/task:0/device:GPU:0}} OOM when allocating tensor with shape[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2] and type double on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc [Op:Fill] name:

/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow/dtensor/python/api.py:64: ResourceExhaustedError
________________ test_diagquad_logspace[var20-mu20-var10-mu10] _________________

mu1 = array([1. , 1.3]), var1 = array([3. , 3.5]), mu2 = array([-2. ,  0.3])
var2 = array([4. , 4.2])

    @pytest.mark.parametrize("mu1", [np.array([1.0, 1.3])])
    @pytest.mark.parametrize("var1", [np.array([3.0, 3.5])])
    @pytest.mark.parametrize("mu2", [np.array([-2.0, 0.3])])
    @pytest.mark.parametrize("var2", [np.array([4.0, 4.2])])
    def test_diagquad_logspace(
        mu1: TensorType, var1: TensorType, mu2: TensorType, var2: TensorType
    ) -> None:
        alpha = 2.5
        num_gauss_hermite_points = 25
>       quad = quadrature.ndiagquad(
            lambda *X: (X[0] + alpha * X[1]),
            num_gauss_hermite_points,
            [mu1, mu2],
            [var1, var2],
            logspace=True,
        )

/local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py:62: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/deprecated.py:72: in ndiagquad
    return ndiagquad(funcs, H, Fmu, Fvar, logspace)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/temp.py:26: in ndiagquad
    quadrature = NDiagGHQuadrature(H, len(Fmu))
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/gauss_hermite.py:121: in __init__
    Z, dZ = ndgh_points_and_weights(self.dim, self.n_gh)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/gauss_hermite.py:109: in ndgh_points_and_weights
    return reshape_Z_dZ(zs, dzs)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/gauss_hermite.py:77: in reshape_Z_dZ
    Z = list_to_flat_grid(zs)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/gauss_hermite.py:59: in list_to_flat_grid
    return tf.reshape(tf.stack(tf.meshgrid(*xs), axis=-1), (-1, len(xs)))
/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow/python/util/traceback_utils.py:153: in error_handler
    raise e.with_traceback(filtered_tb) from None
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

e = _NotOkStatusException(), name = 'stack'

    def raise_from_not_ok_status(e, name) -> NoReturn:
      e.message += (" name: " + str(name if name is not None else ""))
>     raise core._status_to_exception(e) from None  # pylint: disable=protected-access
E     tensorflow.python.framework.errors_impl.ResourceExhaustedError: {{function_node __wrapped__Pack_N_25_device_/job:localhost/replica:0/task:0/device:GPU:0}} OOM when allocating tensor with shape[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,25] and type double on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc [Op:Pack] name: stack

/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow/python/framework/ops.py:6002: ResourceExhaustedError
_____________________ test_diagquad_with_kwarg[var10-mu10] _____________________

mu1 = array([1. , 1.3]), var1 = array([3. , 3.5])

    @pytest.mark.parametrize("mu1", [np.array([1.0, 1.3])])
    @pytest.mark.parametrize("var1", [np.array([3.0, 3.5])])
    def test_diagquad_with_kwarg(mu1: TensorType, var1: TensorType) -> None:
        alpha: AnyNDArray = np.array([2.5, -1.3])
        num_gauss_hermite_points = 25
>       quad = quadrature.ndiagquad(
            lambda X, Y: tf.exp(X * Y), num_gauss_hermite_points, mu1, var1, Y=alpha
        )

/local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py:78: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/deprecated.py:72: in ndiagquad
    return ndiagquad(funcs, H, Fmu, Fvar, logspace)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/temp.py:34: in ndiagquad
    result = quadrature(integrand, Fmu, Fvar)
/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/check_shapes/integration/tf.py:76: in wrapped_method
    return wrapped_function(self, *args, **kwargs)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/base.py:80: in __call__
    X, W = self._build_X_W(mean, var)
/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/check_shapes/integration/tf.py:76: in wrapped_method
    return wrapped_function(self, *args, **kwargs)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/gauss_hermite.py:149: in _build_X_W
    X = mean + stddev * Z
/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow/python/util/traceback_utils.py:153: in error_handler
    raise e.with_traceback(filtered_tb) from None
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

e = _NotOkStatusException(), name = None

    def raise_from_not_ok_status(e, name) -> NoReturn:
      e.message += (" name: " + str(name if name is not None else ""))
>     raise core._status_to_exception(e) from None  # pylint: disable=protected-access
E     tensorflow.python.framework.errors_impl.InvalidArgumentError: {{function_node __wrapped__Mul_device_/job:localhost/replica:0/task:0/device:GPU:0}} required broadcastable shapes [Op:Mul] name:

/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow/python/framework/ops.py:6002: InvalidArgumentError
_____________________ test_ndiagquad_does_not_throw_error ______________________

    def test_ndiagquad_does_not_throw_error() -> None:
        """
        Check that the autograph=False for quadrature.ndiagquad does not throw an error.
        Regression test for https://github.com/GPflow/GPflow/issues/1547.
        """
    
        @tf.function(autograph=False)
        def func_ndiagquad_autograph_false() -> tf.Tensor:
            mu: AnyNDArray = np.array([1.0, 1.3])
            var: AnyNDArray = np.array([3.0, 3.5])
            num_gauss_hermite_points = 25
            return quadrature.ndiagquad(
                [lambda *X: tf.exp(X[0])], num_gauss_hermite_points, [mu], [var]
            )
    
>       func_ndiagquad_autograph_false()

/local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py:100: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow/python/util/traceback_utils.py:153: in error_handler
    raise e.with_traceback(filtered_tb) from None
/local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py:96: in func_ndiagquad_autograph_false
    return quadrature.ndiagquad(
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/deprecated.py:72: in ndiagquad
    return ndiagquad(funcs, H, Fmu, Fvar, logspace)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/temp.py:34: in ndiagquad
    result = quadrature(integrand, Fmu, Fvar)
/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/check_shapes/integration/tf.py:76: in wrapped_method
    return wrapped_function(self, *args, **kwargs)
/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/base.py:80: in __call__
    X, W = self._build_X_W(mean, var)
/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/check_shapes/integration/tf.py:76: in wrapped_method
    return wrapped_function(self, *args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <gpflow.quadrature.gauss_hermite.NDiagGHQuadrature object at 0x7c511926a5d0>
mean = [array([1. , 1.3])], var = [array([3. , 3.5])]

    @inherit_check_shapes
    def _build_X_W(self, mean: TensorType, var: TensorType) -> Tuple[tf.Tensor, tf.Tensor]:
        """
        :param mean: Array/Tensor with shape [b1, b2, ..., bX, dim], usually [N, dim],
            representing the mean of a dim-Variate Gaussian distribution
        :param var: Array/Tensor with shape b1, b2, ..., bX, dim], usually [N, dim],
            representing the variance of a dim-Variate Gaussian distribution
        :return: points X, Tensor with shape [n_gh_total, b1, b2, ..., bX, dim],
            usually [n_gh_total, N, dim],
            and weights W, a Tensor with shape [n_gh_total, b1, b2, ..., bX, 1],
            usually [n_gh_total, N, 1]
        """
    
>       batch_shape_broadcast = tf.ones(tf.rank(mean) - 1, dtype=tf.int32)
E       ValueError: Expected values [array([1. , 1.3])] to be a dense tensor with shape [1], but got shape [1, 2].

/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/gauss_hermite.py:138: ValueError
__________________________ test_quadrature_autograph ___________________________

    def test_quadrature_autograph() -> None:
        """
        Check that the return value is equal with and without Autograph
        Regression test for https://github.com/GPflow/GPflow/issues/1547.
        """
    
        def compute(autograph: bool) -> AnyNDArray:
            @tf.function(autograph=autograph)
            def func() -> tf.Tensor:
                mu: AnyNDArray = np.array([1.0, 1.3])
                var: AnyNDArray = np.array([3.0, 3.5])
                num_gauss_hermite_points = 25
                return quadrature.ndiagquad(
                    [lambda *X: tf.exp(X[0])], num_gauss_hermite_points, [mu], [var]
                )
    
            (result,) = func()
            return cast(AnyNDArray, result.numpy())
    
        np.testing.assert_equal(
>           compute(autograph=True),
            compute(autograph=False),
        )

/local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py:123: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py:119: in compute
    (result,) = func()
/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow/python/util/traceback_utils.py:153: in error_handler
    raise e.with_traceback(filtered_tb) from None
/tmp/__autograph_generated_filelki8ryaw.py:15: in tf__func
    retval_ = ag__.converted_call(ag__.ld(quadrature).ndiagquad, ([ag__.autograph_artifact(lambda *X: ag__.converted_call(ag__.ld(tf).exp, (ag__.ld(X)[0],), None, fscope))], ag__.ld(num_gauss_hermite_points), [ag__.ld(mu)], [ag__.ld(var)]), None, fscope)
/tmp/__autograph_generated_filesy8qprak.py:198: in tf__wrapped_function
    ag__.if_stmt(ag__.not_(do_return), if_body_5, else_body_5, get_state_8, set_state_8, ('arg_map', 'arg_map[RESULT_TOKEN]', 'checker', 'do_return', 'retval_'), 5)
/tmp/__autograph_generated_filezjs1abkj.py:13: in tf__ndiagquad
    retval_ = ag__.converted_call(ag__.ld(ndiagquad), (ag__.ld(funcs), ag__.ld(H), ag__.ld(Fmu), ag__.ld(Fvar), ag__.ld(logspace)), None, fscope)
/tmp/__autograph_generated_fileeao08f6l.py:91: in tf__ndiagquad
    result = ag__.converted_call(ag__.ld(quadrature), (ag__.ld(integrand), ag__.ld(Fmu), ag__.ld(Fvar)), None, fscope)
/tmp/__autograph_generated_file6p8ylohs.py:13: in tf__wrapped_method
    retval_ = ag__.converted_call(ag__.ld(wrapped_function), (ag__.ld(self),) + tuple(ag__.ld(args)), dict(**ag__.ld(kwargs)), fscope)
/tmp/__autograph_generated_filesy8qprak.py:198: in tf__wrapped_function
    ag__.if_stmt(ag__.not_(do_return), if_body_5, else_body_5, get_state_8, set_state_8, ('arg_map', 'arg_map[RESULT_TOKEN]', 'checker', 'do_return', 'retval_'), 5)
/tmp/__autograph_generated_file_xhgzouu.py:35: in tf____call__
    X, W = ag__.converted_call(ag__.ld(self)._build_X_W, (ag__.ld(mean), ag__.ld(var)), None, fscope)
/tmp/__autograph_generated_file6p8ylohs.py:13: in tf__wrapped_method
    retval_ = ag__.converted_call(ag__.ld(wrapped_function), (ag__.ld(self),) + tuple(ag__.ld(args)), dict(**ag__.ld(kwargs)), fscope)
/tmp/__autograph_generated_filesy8qprak.py:198: in tf__wrapped_function
    ag__.if_stmt(ag__.not_(do_return), if_body_5, else_body_5, get_state_8, set_state_8, ('arg_map', 'arg_map[RESULT_TOKEN]', 'checker', 'do_return', 'retval_'), 5)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <gpflow.quadrature.gauss_hermite.NDiagGHQuadrature object at 0x7c5119077050>
mean = [array([1. , 1.3])], var = [array([3. , 3.5])]

    def tf___build_X_W(self, mean: TensorType, var: TensorType) -> Tuple[tf.Tensor, tf.Tensor]:
        """
    :param mean: Array/Tensor with shape [b1, b2, ..., bX, dim], usually [N, dim],
        representing the mean of a dim-Variate Gaussian distribution
    :param var: Array/Tensor with shape b1, b2, ..., bX, dim], usually [N, dim],
        representing the variance of a dim-Variate Gaussian distribution
    :return: points X, Tensor with shape [n_gh_total, b1, b2, ..., bX, dim],
        usually [n_gh_total, N, dim],
        and weights W, a Tensor with shape [n_gh_total, b1, b2, ..., bX, 1],
        usually [n_gh_total, N, 1]
    """
        with ag__.FunctionScope('_build_X_W', 'fscope', ag__.STD) as fscope:
            do_return = False
            retval_ = ag__.UndefinedReturnValue()
>           batch_shape_broadcast = ag__.converted_call(ag__.ld(tf).ones, (ag__.converted_call(ag__.ld(tf).rank, (ag__.ld(mean),), None, fscope) - 1,), dict(dtype=ag__.ld(tf).int32), fscope)
E           ValueError: in user code:
E           
E               File "/local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py", line 116, in func  *
E                   [lambda *X: tf.exp(X[0])], num_gauss_hermite_points, [mu], [var]
E               File "/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/check_shapes/decorator.py", line 69, in wrapped_function  *
E                   def wrapped_function(*args: Any, **kwargs: Any) -> Any:
E               File "/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/deprecated.py", line 72, in ndiagquad  *
E                   return ndiagquad(funcs, H, Fmu, Fvar, logspace)
E               File "/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/temp.py", line 34, in ndiagquad  *
E                   result = quadrature(integrand, Fmu, Fvar)
E               File "/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/check_shapes/integration/tf.py", line 42, in wrapped_method  *
E                   return wrapped_function(self, *args, **kwargs)
E               File "/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/check_shapes/decorator.py", line 69, in wrapped_function  *
E                   def wrapped_function(*args: Any, **kwargs: Any) -> Any:
E               File "/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/base.py", line 80, in __call__  *
E                   X, W = self._build_X_W(mean, var)
E               File "/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/check_shapes/integration/tf.py", line 42, in wrapped_method  *
E                   return wrapped_function(self, *args, **kwargs)
E               File "/local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/check_shapes/decorator.py", line 69, in wrapped_function  *
E                   def wrapped_function(*args: Any, **kwargs: Any) -> Any:
E               File "/local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/gauss_hermite.py", line 138, in _build_X_W  *
E                   batch_shape_broadcast = tf.ones(tf.rank(mean) - 1, dtype=tf.int32)
E           
E               ValueError: Expected values [array([1. , 1.3])] to be a dense tensor with shape [1], but got shape [1, 2].

/tmp/__autograph_generated_filev9z0xond.py:20: ValueError
=============================== warnings summary ===============================
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow_probability/python/__init__.py:57
  /local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow_probability/python/__init__.py:57: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if (distutils.version.LooseVersion(tf.__version__) <

../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow_probability/python/__init__.py:58
  /local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow_probability/python/__init__.py:58: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    distutils.version.LooseVersion(required_tensorflow_version)):

tests/gpflow/quadrature/test_quadrature.py::test_diagquad_1d[var0-mu0]
tests/gpflow/quadrature/test_quadrature.py::test_diagquad_2d[var20-mu20-var10-mu10]
tests/gpflow/quadrature/test_quadrature.py::test_diagquad_logspace[var20-mu20-var10-mu10]
tests/gpflow/quadrature/test_quadrature.py::test_diagquad_with_kwarg[var10-mu10]
tests/gpflow/quadrature/test_quadrature.py::test_ndiagquad_does_not_throw_error
  /local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/temp.py:19: DeprecationWarning: ndiagquad is deprecated. Please use gpflow.quadrature.NDiagGHQuadrature instead.
    warnings.warn('ndiagquad is deprecated. Please use gpflow.quadrature.NDiagGHQuadrature instead.', DeprecationWarning)

tests/gpflow/quadrature/test_quadrature.py::test_quadrature_autograph
  /local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow/python/autograph/impl/api.py:371: DeprecationWarning: ndiagquad is deprecated. Please use gpflow.quadrature.NDiagGHQuadrature instead.
    return py_builtins.overload_of(f)(*args)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED ../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_1d[var0-mu0]
FAILED ../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_2d[var20-mu20-var10-mu10]
FAILED ../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_logspace[var20-mu20-var10-mu10]
FAILED ../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_with_kwarg[var10-mu10]
FAILED ../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_ndiagquad_does_not_throw_error
FAILED ../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_quadrature_autograph
======================== 6 failed, 8 warnings in 23.05s ========================


Final Test Result:
============================= test session starts ==============================
platform linux -- Python 3.11.10, pytest-8.3.4, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/GPflow/GPflow/venv/bin/python
cachedir: .pytest_cache
rootdir: /local/data0/moved_data/publishablew/GPflow/GPflow
collecting ... collected 6 items

../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_1d[var0-mu0] PASSED
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_2d[var20-mu20-var10-mu10] PASSED
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_logspace[var20-mu20-var10-mu10] PASSED
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_with_kwarg[var10-mu10] PASSED
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_ndiagquad_does_not_throw_error PASSED
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_quadrature_autograph PASSED

=============================== warnings summary ===============================
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow_probability/python/__init__.py:57
  /local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow_probability/python/__init__.py:57: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if (distutils.version.LooseVersion(tf.__version__) <

../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow_probability/python/__init__.py:58
  /local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow_probability/python/__init__.py:58: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    distutils.version.LooseVersion(required_tensorflow_version)):

tests/gpflow/quadrature/test_quadrature.py::test_diagquad_1d[var0-mu0]
tests/gpflow/quadrature/test_quadrature.py::test_diagquad_2d[var20-mu20-var10-mu10]
tests/gpflow/quadrature/test_quadrature.py::test_diagquad_logspace[var20-mu20-var10-mu10]
tests/gpflow/quadrature/test_quadrature.py::test_diagquad_with_kwarg[var10-mu10]
tests/gpflow/quadrature/test_quadrature.py::test_ndiagquad_does_not_throw_error
tests/gpflow/quadrature/test_quadrature.py::test_quadrature_autograph
  /local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/deprecated.py:165: DeprecationWarning: Please use gpflow.quadrature.NDiagGHQuadrature instead (note the changed convention of how multi-dimensional quadrature is handled)
    warnings.warn(

tests/gpflow/quadrature/test_quadrature.py::test_quadrature_autograph
  /local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow/python/autograph/impl/api.py:371: DeprecationWarning: Please use gpflow.quadrature.NDiagGHQuadrature instead (note the changed convention of how multi-dimensional quadrature is handled)
    return py_builtins.overload_of(f)(*args)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================== 6 passed, 9 warnings in 2.61s =========================


Initial Result:
============================= test session starts ==============================
platform linux -- Python 3.11.10, pytest-8.3.4, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/GPflow/GPflow/venv/bin/python
cachedir: .pytest_cache
rootdir: /local/data0/moved_data/publishablew/GPflow/GPflow
collecting ... collected 6 items

../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_1d[var0-mu0] PASSED
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_2d[var20-mu20-var10-mu10] PASSED
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_logspace[var20-mu20-var10-mu10] PASSED
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_diagquad_with_kwarg[var10-mu10] PASSED
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_ndiagquad_does_not_throw_error PASSED
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/tests/gpflow/quadrature/test_quadrature.py::test_quadrature_autograph PASSED

=============================== warnings summary ===============================
../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow_probability/python/__init__.py:57
  /local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow_probability/python/__init__.py:57: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if (distutils.version.LooseVersion(tf.__version__) <

../../../../../../local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow_probability/python/__init__.py:58
  /local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow_probability/python/__init__.py:58: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    distutils.version.LooseVersion(required_tensorflow_version)):

tests/gpflow/quadrature/test_quadrature.py::test_diagquad_1d[var0-mu0]
tests/gpflow/quadrature/test_quadrature.py::test_diagquad_2d[var20-mu20-var10-mu10]
tests/gpflow/quadrature/test_quadrature.py::test_diagquad_logspace[var20-mu20-var10-mu10]
tests/gpflow/quadrature/test_quadrature.py::test_diagquad_with_kwarg[var10-mu10]
tests/gpflow/quadrature/test_quadrature.py::test_ndiagquad_does_not_throw_error
tests/gpflow/quadrature/test_quadrature.py::test_quadrature_autograph
  /local/data0/moved_data/publishablew/GPflow/GPflow/gpflow/quadrature/deprecated.py:165: DeprecationWarning: Please use gpflow.quadrature.NDiagGHQuadrature instead (note the changed convention of how multi-dimensional quadrature is handled)
    warnings.warn(

tests/gpflow/quadrature/test_quadrature.py::test_quadrature_autograph
  /local/data0/moved_data/publishablew/GPflow/GPflow/venv/lib/python3.11/site-packages/tensorflow/python/autograph/impl/api.py:371: DeprecationWarning: Please use gpflow.quadrature.NDiagGHQuadrature instead (note the changed convention of how multi-dimensional quadrature is handled)
    return py_builtins.overload_of(f)(*args)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================== 6 passed, 9 warnings in 2.61s =========================
