output file:
processed_pfrlcompute_policy_gradient_full_correction318.json
function:
compute_policy_gradient_full_correction
Error Cases:

Pass or Failed: 0

Related Failed Test Cases:
{'FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-True-Softmax]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-True-Softmax]', '../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-True-Softmax] FAILED', '../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-True-Softmax] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-False-Softmax]', '../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-False-Softmax] FAILED', '../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-False-Softmax] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-False-Softmax]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-False-Softmax]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-False-Softmax]', '../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-True-Softmax] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-False-Softmax]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-True-Softmax]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-True-Softmax]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-False-Softmax]', '../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-True-Softmax] FAILED', '../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-True-Softmax] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-True-Softmax]', '../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-True-Softmax] FAILED', '../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-False-Softmax] FAILED', '../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-False-Softmax] FAILED', '../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-False-Softmax] FAILED', '../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-False-Softmax] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-True-Softmax]'}

All Test Cases On Generated code:
============================= test session starts ==============================
platform linux -- Python 3.11.10, pytest-8.3.4, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/pfrl/pfrl/venv/bin/python
cachedir: .pytest_cache
rootdir: /local/data0/moved_data/publishablew/pfrl/pfrl
configfile: pytest.ini
collecting ... collected 32 items

../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-True-Softmax] FAILED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-False-Softmax] FAILED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-True-Softmax] FAILED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-False-Softmax] FAILED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-True-Softmax] FAILED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-False-Softmax] FAILED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-True-Softmax] FAILED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-False-Softmax] FAILED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-True-Softmax] FAILED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-False-Softmax] FAILED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-True-Softmax] FAILED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-False-Softmax] FAILED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-True-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-True-True-Softmax] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-True-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-True-False-Softmax] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-False-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-False-True-Softmax] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-False-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-False-False-Softmax] SKIPPED

=================================== FAILURES ===================================
__ TestDegenerateDistribution.test_full_correction_term[0-True-True-Softmax] ___

self = <test_acer.TestDegenerateDistribution object at 0x78e086ae7d90>

    def test_full_correction_term(self):
        if self.distrib_type == "Gaussian":
            pytest.skip()
        if self.truncation_threshold is None:
            pytest.skip()
>       correction_term = acer.compute_policy_gradient_full_correction(
            self.pi, self.mu, self.action_value, 0, self.truncation_threshold
        )

/local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:88: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/acer.py:26: in compute_policy_gradient_full_correction
    return compute_policy_gradient_full_correction(action_distrib, action_distrib_mu, action_value, v, truncation_threshold)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

action_distrib = Categorical(probs: torch.Size([1, 2]))
action_distrib_mu = Categorical(probs: torch.Size([1, 2]))
action_value = DiscreteActionValue greedy_actions:[1] q_values:[[1. 3.]], v = 0
truncation_threshold = 0

    def compute_policy_gradient_full_correction(action_distrib: torch.distributions.Categorical, action_distrib_mu: torch.distributions.Categorical, action_value: torch.Tensor, v: float, truncation_threshold: float) -> torch.Tensor:
        """
        Calculate the off-policy bias correction term for all actions.
    
        Args:
            action_distrib (torch.distributions.Categorical): The target policy distribution.
            action_distrib_mu (torch.distributions.Categorical): The behavior policy distribution.
            action_value (torch.Tensor): The action-value function (Q-values).
            v (float): A scalar value for baseline or value function.
            truncation_threshold (float): The threshold for truncating importance weights.
    
        Returns:
            torch.Tensor: The corrected policy gradient.
        """
        assert isinstance(action_distrib, torch.distributions.Categorical), 'action_distrib must be a Categorical distribution.'
        assert isinstance(action_distrib_mu, torch.distributions.Categorical), 'action_distrib_mu must be a Categorical distribution.'
>       assert isinstance(action_value, torch.Tensor), 'action_value must be a torch.Tensor.'
E       AssertionError: action_value must be a torch.Tensor.

/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/temp.py:30: AssertionError
__ TestDegenerateDistribution.test_full_correction_term[0-True-False-Softmax] __

self = <test_acer.TestDegenerateDistribution object at 0x78e086ae8110>

    def test_full_correction_term(self):
        if self.distrib_type == "Gaussian":
            pytest.skip()
        if self.truncation_threshold is None:
            pytest.skip()
>       correction_term = acer.compute_policy_gradient_full_correction(
            self.pi, self.mu, self.action_value, 0, self.truncation_threshold
        )

/local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:88: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/acer.py:26: in compute_policy_gradient_full_correction
    return compute_policy_gradient_full_correction(action_distrib, action_distrib_mu, action_value, v, truncation_threshold)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

action_distrib = Categorical(logits: torch.Size([1, 2]))
action_distrib_mu = Categorical(probs: torch.Size([1, 2]))
action_value = DiscreteActionValue greedy_actions:[1] q_values:[[1. 3.]], v = 0
truncation_threshold = 0

    def compute_policy_gradient_full_correction(action_distrib: torch.distributions.Categorical, action_distrib_mu: torch.distributions.Categorical, action_value: torch.Tensor, v: float, truncation_threshold: float) -> torch.Tensor:
        """
        Calculate the off-policy bias correction term for all actions.
    
        Args:
            action_distrib (torch.distributions.Categorical): The target policy distribution.
            action_distrib_mu (torch.distributions.Categorical): The behavior policy distribution.
            action_value (torch.Tensor): The action-value function (Q-values).
            v (float): A scalar value for baseline or value function.
            truncation_threshold (float): The threshold for truncating importance weights.
    
        Returns:
            torch.Tensor: The corrected policy gradient.
        """
        assert isinstance(action_distrib, torch.distributions.Categorical), 'action_distrib must be a Categorical distribution.'
        assert isinstance(action_distrib_mu, torch.distributions.Categorical), 'action_distrib_mu must be a Categorical distribution.'
>       assert isinstance(action_value, torch.Tensor), 'action_value must be a torch.Tensor.'
E       AssertionError: action_value must be a torch.Tensor.

/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/temp.py:30: AssertionError
__ TestDegenerateDistribution.test_full_correction_term[0-False-True-Softmax] __

self = <test_acer.TestDegenerateDistribution object at 0x78e086ae8590>

    def test_full_correction_term(self):
        if self.distrib_type == "Gaussian":
            pytest.skip()
        if self.truncation_threshold is None:
            pytest.skip()
>       correction_term = acer.compute_policy_gradient_full_correction(
            self.pi, self.mu, self.action_value, 0, self.truncation_threshold
        )

/local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:88: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/acer.py:26: in compute_policy_gradient_full_correction
    return compute_policy_gradient_full_correction(action_distrib, action_distrib_mu, action_value, v, truncation_threshold)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

action_distrib = Categorical(probs: torch.Size([1, 2]))
action_distrib_mu = Categorical(logits: torch.Size([1, 2]))
action_value = DiscreteActionValue greedy_actions:[1] q_values:[[1. 3.]], v = 0
truncation_threshold = 0

    def compute_policy_gradient_full_correction(action_distrib: torch.distributions.Categorical, action_distrib_mu: torch.distributions.Categorical, action_value: torch.Tensor, v: float, truncation_threshold: float) -> torch.Tensor:
        """
        Calculate the off-policy bias correction term for all actions.
    
        Args:
            action_distrib (torch.distributions.Categorical): The target policy distribution.
            action_distrib_mu (torch.distributions.Categorical): The behavior policy distribution.
            action_value (torch.Tensor): The action-value function (Q-values).
            v (float): A scalar value for baseline or value function.
            truncation_threshold (float): The threshold for truncating importance weights.
    
        Returns:
            torch.Tensor: The corrected policy gradient.
        """
        assert isinstance(action_distrib, torch.distributions.Categorical), 'action_distrib must be a Categorical distribution.'
        assert isinstance(action_distrib_mu, torch.distributions.Categorical), 'action_distrib_mu must be a Categorical distribution.'
>       assert isinstance(action_value, torch.Tensor), 'action_value must be a torch.Tensor.'
E       AssertionError: action_value must be a torch.Tensor.

/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/temp.py:30: AssertionError
_ TestDegenerateDistribution.test_full_correction_term[0-False-False-Softmax] __

self = <test_acer.TestDegenerateDistribution object at 0x78e086ae8e10>

    def test_full_correction_term(self):
        if self.distrib_type == "Gaussian":
            pytest.skip()
        if self.truncation_threshold is None:
            pytest.skip()
>       correction_term = acer.compute_policy_gradient_full_correction(
            self.pi, self.mu, self.action_value, 0, self.truncation_threshold
        )

/local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:88: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/acer.py:26: in compute_policy_gradient_full_correction
    return compute_policy_gradient_full_correction(action_distrib, action_distrib_mu, action_value, v, truncation_threshold)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

action_distrib = Categorical(logits: torch.Size([1, 2]))
action_distrib_mu = Categorical(logits: torch.Size([1, 2]))
action_value = DiscreteActionValue greedy_actions:[1] q_values:[[1. 3.]], v = 0
truncation_threshold = 0

    def compute_policy_gradient_full_correction(action_distrib: torch.distributions.Categorical, action_distrib_mu: torch.distributions.Categorical, action_value: torch.Tensor, v: float, truncation_threshold: float) -> torch.Tensor:
        """
        Calculate the off-policy bias correction term for all actions.
    
        Args:
            action_distrib (torch.distributions.Categorical): The target policy distribution.
            action_distrib_mu (torch.distributions.Categorical): The behavior policy distribution.
            action_value (torch.Tensor): The action-value function (Q-values).
            v (float): A scalar value for baseline or value function.
            truncation_threshold (float): The threshold for truncating importance weights.
    
        Returns:
            torch.Tensor: The corrected policy gradient.
        """
        assert isinstance(action_distrib, torch.distributions.Categorical), 'action_distrib must be a Categorical distribution.'
        assert isinstance(action_distrib_mu, torch.distributions.Categorical), 'action_distrib_mu must be a Categorical distribution.'
>       assert isinstance(action_value, torch.Tensor), 'action_value must be a torch.Tensor.'
E       AssertionError: action_value must be a torch.Tensor.

/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/temp.py:30: AssertionError
__ TestDegenerateDistribution.test_full_correction_term[1-True-True-Softmax] ___

self = <test_acer.TestDegenerateDistribution object at 0x78e086af0090>

    def test_full_correction_term(self):
        if self.distrib_type == "Gaussian":
            pytest.skip()
        if self.truncation_threshold is None:
            pytest.skip()
>       correction_term = acer.compute_policy_gradient_full_correction(
            self.pi, self.mu, self.action_value, 0, self.truncation_threshold
        )

/local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:88: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/acer.py:26: in compute_policy_gradient_full_correction
    return compute_policy_gradient_full_correction(action_distrib, action_distrib_mu, action_value, v, truncation_threshold)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

action_distrib = Categorical(probs: torch.Size([1, 2]))
action_distrib_mu = Categorical(probs: torch.Size([1, 2]))
action_value = DiscreteActionValue greedy_actions:[1] q_values:[[1. 3.]], v = 0
truncation_threshold = 1

    def compute_policy_gradient_full_correction(action_distrib: torch.distributions.Categorical, action_distrib_mu: torch.distributions.Categorical, action_value: torch.Tensor, v: float, truncation_threshold: float) -> torch.Tensor:
        """
        Calculate the off-policy bias correction term for all actions.
    
        Args:
            action_distrib (torch.distributions.Categorical): The target policy distribution.
            action_distrib_mu (torch.distributions.Categorical): The behavior policy distribution.
            action_value (torch.Tensor): The action-value function (Q-values).
            v (float): A scalar value for baseline or value function.
            truncation_threshold (float): The threshold for truncating importance weights.
    
        Returns:
            torch.Tensor: The corrected policy gradient.
        """
        assert isinstance(action_distrib, torch.distributions.Categorical), 'action_distrib must be a Categorical distribution.'
        assert isinstance(action_distrib_mu, torch.distributions.Categorical), 'action_distrib_mu must be a Categorical distribution.'
>       assert isinstance(action_value, torch.Tensor), 'action_value must be a torch.Tensor.'
E       AssertionError: action_value must be a torch.Tensor.

/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/temp.py:30: AssertionError
__ TestDegenerateDistribution.test_full_correction_term[1-True-False-Softmax] __

self = <test_acer.TestDegenerateDistribution object at 0x78e086af0590>

    def test_full_correction_term(self):
        if self.distrib_type == "Gaussian":
            pytest.skip()
        if self.truncation_threshold is None:
            pytest.skip()
>       correction_term = acer.compute_policy_gradient_full_correction(
            self.pi, self.mu, self.action_value, 0, self.truncation_threshold
        )

/local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:88: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/acer.py:26: in compute_policy_gradient_full_correction
    return compute_policy_gradient_full_correction(action_distrib, action_distrib_mu, action_value, v, truncation_threshold)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

action_distrib = Categorical(logits: torch.Size([1, 2]))
action_distrib_mu = Categorical(probs: torch.Size([1, 2]))
action_value = DiscreteActionValue greedy_actions:[1] q_values:[[1. 3.]], v = 0
truncation_threshold = 1

    def compute_policy_gradient_full_correction(action_distrib: torch.distributions.Categorical, action_distrib_mu: torch.distributions.Categorical, action_value: torch.Tensor, v: float, truncation_threshold: float) -> torch.Tensor:
        """
        Calculate the off-policy bias correction term for all actions.
    
        Args:
            action_distrib (torch.distributions.Categorical): The target policy distribution.
            action_distrib_mu (torch.distributions.Categorical): The behavior policy distribution.
            action_value (torch.Tensor): The action-value function (Q-values).
            v (float): A scalar value for baseline or value function.
            truncation_threshold (float): The threshold for truncating importance weights.
    
        Returns:
            torch.Tensor: The corrected policy gradient.
        """
        assert isinstance(action_distrib, torch.distributions.Categorical), 'action_distrib must be a Categorical distribution.'
        assert isinstance(action_distrib_mu, torch.distributions.Categorical), 'action_distrib_mu must be a Categorical distribution.'
>       assert isinstance(action_value, torch.Tensor), 'action_value must be a torch.Tensor.'
E       AssertionError: action_value must be a torch.Tensor.

/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/temp.py:30: AssertionError
__ TestDegenerateDistribution.test_full_correction_term[1-False-True-Softmax] __

self = <test_acer.TestDegenerateDistribution object at 0x78e086af0a90>

    def test_full_correction_term(self):
        if self.distrib_type == "Gaussian":
            pytest.skip()
        if self.truncation_threshold is None:
            pytest.skip()
>       correction_term = acer.compute_policy_gradient_full_correction(
            self.pi, self.mu, self.action_value, 0, self.truncation_threshold
        )

/local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:88: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/acer.py:26: in compute_policy_gradient_full_correction
    return compute_policy_gradient_full_correction(action_distrib, action_distrib_mu, action_value, v, truncation_threshold)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

action_distrib = Categorical(probs: torch.Size([1, 2]))
action_distrib_mu = Categorical(logits: torch.Size([1, 2]))
action_value = DiscreteActionValue greedy_actions:[1] q_values:[[1. 3.]], v = 0
truncation_threshold = 1

    def compute_policy_gradient_full_correction(action_distrib: torch.distributions.Categorical, action_distrib_mu: torch.distributions.Categorical, action_value: torch.Tensor, v: float, truncation_threshold: float) -> torch.Tensor:
        """
        Calculate the off-policy bias correction term for all actions.
    
        Args:
            action_distrib (torch.distributions.Categorical): The target policy distribution.
            action_distrib_mu (torch.distributions.Categorical): The behavior policy distribution.
            action_value (torch.Tensor): The action-value function (Q-values).
            v (float): A scalar value for baseline or value function.
            truncation_threshold (float): The threshold for truncating importance weights.
    
        Returns:
            torch.Tensor: The corrected policy gradient.
        """
        assert isinstance(action_distrib, torch.distributions.Categorical), 'action_distrib must be a Categorical distribution.'
        assert isinstance(action_distrib_mu, torch.distributions.Categorical), 'action_distrib_mu must be a Categorical distribution.'
>       assert isinstance(action_value, torch.Tensor), 'action_value must be a torch.Tensor.'
E       AssertionError: action_value must be a torch.Tensor.

/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/temp.py:30: AssertionError
_ TestDegenerateDistribution.test_full_correction_term[1-False-False-Softmax] __

self = <test_acer.TestDegenerateDistribution object at 0x78e086af0f90>

    def test_full_correction_term(self):
        if self.distrib_type == "Gaussian":
            pytest.skip()
        if self.truncation_threshold is None:
            pytest.skip()
>       correction_term = acer.compute_policy_gradient_full_correction(
            self.pi, self.mu, self.action_value, 0, self.truncation_threshold
        )

/local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:88: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/acer.py:26: in compute_policy_gradient_full_correction
    return compute_policy_gradient_full_correction(action_distrib, action_distrib_mu, action_value, v, truncation_threshold)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

action_distrib = Categorical(logits: torch.Size([1, 2]))
action_distrib_mu = Categorical(logits: torch.Size([1, 2]))
action_value = DiscreteActionValue greedy_actions:[1] q_values:[[1. 3.]], v = 0
truncation_threshold = 1

    def compute_policy_gradient_full_correction(action_distrib: torch.distributions.Categorical, action_distrib_mu: torch.distributions.Categorical, action_value: torch.Tensor, v: float, truncation_threshold: float) -> torch.Tensor:
        """
        Calculate the off-policy bias correction term for all actions.
    
        Args:
            action_distrib (torch.distributions.Categorical): The target policy distribution.
            action_distrib_mu (torch.distributions.Categorical): The behavior policy distribution.
            action_value (torch.Tensor): The action-value function (Q-values).
            v (float): A scalar value for baseline or value function.
            truncation_threshold (float): The threshold for truncating importance weights.
    
        Returns:
            torch.Tensor: The corrected policy gradient.
        """
        assert isinstance(action_distrib, torch.distributions.Categorical), 'action_distrib must be a Categorical distribution.'
        assert isinstance(action_distrib_mu, torch.distributions.Categorical), 'action_distrib_mu must be a Categorical distribution.'
>       assert isinstance(action_value, torch.Tensor), 'action_value must be a torch.Tensor.'
E       AssertionError: action_value must be a torch.Tensor.

/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/temp.py:30: AssertionError
__ TestDegenerateDistribution.test_full_correction_term[10-True-True-Softmax] __

self = <test_acer.TestDegenerateDistribution object at 0x78e086af1490>

    def test_full_correction_term(self):
        if self.distrib_type == "Gaussian":
            pytest.skip()
        if self.truncation_threshold is None:
            pytest.skip()
>       correction_term = acer.compute_policy_gradient_full_correction(
            self.pi, self.mu, self.action_value, 0, self.truncation_threshold
        )

/local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:88: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/acer.py:26: in compute_policy_gradient_full_correction
    return compute_policy_gradient_full_correction(action_distrib, action_distrib_mu, action_value, v, truncation_threshold)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

action_distrib = Categorical(probs: torch.Size([1, 2]))
action_distrib_mu = Categorical(probs: torch.Size([1, 2]))
action_value = DiscreteActionValue greedy_actions:[1] q_values:[[1. 3.]], v = 0
truncation_threshold = 10

    def compute_policy_gradient_full_correction(action_distrib: torch.distributions.Categorical, action_distrib_mu: torch.distributions.Categorical, action_value: torch.Tensor, v: float, truncation_threshold: float) -> torch.Tensor:
        """
        Calculate the off-policy bias correction term for all actions.
    
        Args:
            action_distrib (torch.distributions.Categorical): The target policy distribution.
            action_distrib_mu (torch.distributions.Categorical): The behavior policy distribution.
            action_value (torch.Tensor): The action-value function (Q-values).
            v (float): A scalar value for baseline or value function.
            truncation_threshold (float): The threshold for truncating importance weights.
    
        Returns:
            torch.Tensor: The corrected policy gradient.
        """
        assert isinstance(action_distrib, torch.distributions.Categorical), 'action_distrib must be a Categorical distribution.'
        assert isinstance(action_distrib_mu, torch.distributions.Categorical), 'action_distrib_mu must be a Categorical distribution.'
>       assert isinstance(action_value, torch.Tensor), 'action_value must be a torch.Tensor.'
E       AssertionError: action_value must be a torch.Tensor.

/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/temp.py:30: AssertionError
_ TestDegenerateDistribution.test_full_correction_term[10-True-False-Softmax] __

self = <test_acer.TestDegenerateDistribution object at 0x78e086af19d0>

    def test_full_correction_term(self):
        if self.distrib_type == "Gaussian":
            pytest.skip()
        if self.truncation_threshold is None:
            pytest.skip()
>       correction_term = acer.compute_policy_gradient_full_correction(
            self.pi, self.mu, self.action_value, 0, self.truncation_threshold
        )

/local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:88: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/acer.py:26: in compute_policy_gradient_full_correction
    return compute_policy_gradient_full_correction(action_distrib, action_distrib_mu, action_value, v, truncation_threshold)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

action_distrib = Categorical(logits: torch.Size([1, 2]))
action_distrib_mu = Categorical(probs: torch.Size([1, 2]))
action_value = DiscreteActionValue greedy_actions:[1] q_values:[[1. 3.]], v = 0
truncation_threshold = 10

    def compute_policy_gradient_full_correction(action_distrib: torch.distributions.Categorical, action_distrib_mu: torch.distributions.Categorical, action_value: torch.Tensor, v: float, truncation_threshold: float) -> torch.Tensor:
        """
        Calculate the off-policy bias correction term for all actions.
    
        Args:
            action_distrib (torch.distributions.Categorical): The target policy distribution.
            action_distrib_mu (torch.distributions.Categorical): The behavior policy distribution.
            action_value (torch.Tensor): The action-value function (Q-values).
            v (float): A scalar value for baseline or value function.
            truncation_threshold (float): The threshold for truncating importance weights.
    
        Returns:
            torch.Tensor: The corrected policy gradient.
        """
        assert isinstance(action_distrib, torch.distributions.Categorical), 'action_distrib must be a Categorical distribution.'
        assert isinstance(action_distrib_mu, torch.distributions.Categorical), 'action_distrib_mu must be a Categorical distribution.'
>       assert isinstance(action_value, torch.Tensor), 'action_value must be a torch.Tensor.'
E       AssertionError: action_value must be a torch.Tensor.

/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/temp.py:30: AssertionError
_ TestDegenerateDistribution.test_full_correction_term[10-False-True-Softmax] __

self = <test_acer.TestDegenerateDistribution object at 0x78e086af1fd0>

    def test_full_correction_term(self):
        if self.distrib_type == "Gaussian":
            pytest.skip()
        if self.truncation_threshold is None:
            pytest.skip()
>       correction_term = acer.compute_policy_gradient_full_correction(
            self.pi, self.mu, self.action_value, 0, self.truncation_threshold
        )

/local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:88: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/acer.py:26: in compute_policy_gradient_full_correction
    return compute_policy_gradient_full_correction(action_distrib, action_distrib_mu, action_value, v, truncation_threshold)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

action_distrib = Categorical(probs: torch.Size([1, 2]))
action_distrib_mu = Categorical(logits: torch.Size([1, 2]))
action_value = DiscreteActionValue greedy_actions:[1] q_values:[[1. 3.]], v = 0
truncation_threshold = 10

    def compute_policy_gradient_full_correction(action_distrib: torch.distributions.Categorical, action_distrib_mu: torch.distributions.Categorical, action_value: torch.Tensor, v: float, truncation_threshold: float) -> torch.Tensor:
        """
        Calculate the off-policy bias correction term for all actions.
    
        Args:
            action_distrib (torch.distributions.Categorical): The target policy distribution.
            action_distrib_mu (torch.distributions.Categorical): The behavior policy distribution.
            action_value (torch.Tensor): The action-value function (Q-values).
            v (float): A scalar value for baseline or value function.
            truncation_threshold (float): The threshold for truncating importance weights.
    
        Returns:
            torch.Tensor: The corrected policy gradient.
        """
        assert isinstance(action_distrib, torch.distributions.Categorical), 'action_distrib must be a Categorical distribution.'
        assert isinstance(action_distrib_mu, torch.distributions.Categorical), 'action_distrib_mu must be a Categorical distribution.'
>       assert isinstance(action_value, torch.Tensor), 'action_value must be a torch.Tensor.'
E       AssertionError: action_value must be a torch.Tensor.

/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/temp.py:30: AssertionError
_ TestDegenerateDistribution.test_full_correction_term[10-False-False-Softmax] _

self = <test_acer.TestDegenerateDistribution object at 0x78e086af25d0>

    def test_full_correction_term(self):
        if self.distrib_type == "Gaussian":
            pytest.skip()
        if self.truncation_threshold is None:
            pytest.skip()
>       correction_term = acer.compute_policy_gradient_full_correction(
            self.pi, self.mu, self.action_value, 0, self.truncation_threshold
        )

/local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:88: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/acer.py:26: in compute_policy_gradient_full_correction
    return compute_policy_gradient_full_correction(action_distrib, action_distrib_mu, action_value, v, truncation_threshold)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

action_distrib = Categorical(logits: torch.Size([1, 2]))
action_distrib_mu = Categorical(logits: torch.Size([1, 2]))
action_value = DiscreteActionValue greedy_actions:[1] q_values:[[1. 3.]], v = 0
truncation_threshold = 10

    def compute_policy_gradient_full_correction(action_distrib: torch.distributions.Categorical, action_distrib_mu: torch.distributions.Categorical, action_value: torch.Tensor, v: float, truncation_threshold: float) -> torch.Tensor:
        """
        Calculate the off-policy bias correction term for all actions.
    
        Args:
            action_distrib (torch.distributions.Categorical): The target policy distribution.
            action_distrib_mu (torch.distributions.Categorical): The behavior policy distribution.
            action_value (torch.Tensor): The action-value function (Q-values).
            v (float): A scalar value for baseline or value function.
            truncation_threshold (float): The threshold for truncating importance weights.
    
        Returns:
            torch.Tensor: The corrected policy gradient.
        """
        assert isinstance(action_distrib, torch.distributions.Categorical), 'action_distrib must be a Categorical distribution.'
        assert isinstance(action_distrib_mu, torch.distributions.Categorical), 'action_distrib_mu must be a Categorical distribution.'
>       assert isinstance(action_value, torch.Tensor), 'action_value must be a torch.Tensor.'
E       AssertionError: action_value must be a torch.Tensor.

/local/data0/moved_data/publishablew/pfrl/pfrl/pfrl/agents/temp.py:30: AssertionError
=============================== warnings summary ===============================
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:326
  /local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:326: PytestUnknownMarkWarning: Unknown pytest.mark.async_ - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.async_

../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:333
  /local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:333: PytestUnknownMarkWarning: Unknown pytest.mark.async_ - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.async_

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-True-Softmax]
FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-False-Softmax]
FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-True-Softmax]
FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-False-Softmax]
FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-True-Softmax]
FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-False-Softmax]
FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-True-Softmax]
FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-False-Softmax]
FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-True-Softmax]
FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-False-Softmax]
FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-True-Softmax]
FAILED ../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-False-Softmax]
================== 12 failed, 20 skipped, 2 warnings in 1.14s ==================


Final Test Result:
============================= test session starts ==============================
platform linux -- Python 3.11.10, pytest-8.3.4, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/pfrl/pfrl/venv/bin/python
cachedir: .pytest_cache
rootdir: /local/data0/moved_data/publishablew/pfrl/pfrl
configfile: pytest.ini
collecting ... collected 32 items

../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-True-Softmax] correction_term tensor([1.1921e-07])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-False-Softmax] correction_term tensor([1.3863])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-True-Softmax] correction_term tensor([1.1921e-07])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-False-Softmax] correction_term tensor([1.3863])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-True-Softmax] correction_term tensor([-0.])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-False-Softmax] correction_term tensor([1.0397])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-True-Softmax] correction_term tensor([5.9605e-08])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-False-Softmax] correction_term tensor([-0.])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-True-Softmax] correction_term tensor([-0.])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-False-Softmax] correction_term tensor([1.0397])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-True-Softmax] correction_term tensor([-0.])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-False-Softmax] correction_term tensor([-0.])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-True-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-True-True-Softmax] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-True-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-True-False-Softmax] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-False-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-False-True-Softmax] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-False-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-False-False-Softmax] SKIPPED

=============================== warnings summary ===============================
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:326
  /local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:326: PytestUnknownMarkWarning: Unknown pytest.mark.async_ - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.async_

../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:333
  /local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:333: PytestUnknownMarkWarning: Unknown pytest.mark.async_ - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.async_

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================== 12 passed, 20 skipped, 2 warnings in 0.95s ==================


Initial Result:
============================= test session starts ==============================
platform linux -- Python 3.11.10, pytest-8.3.4, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/pfrl/pfrl/venv/bin/python
cachedir: .pytest_cache
rootdir: /local/data0/moved_data/publishablew/pfrl/pfrl
configfile: pytest.ini
collecting ... collected 32 items

../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-True-Softmax] correction_term tensor([1.1921e-07])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-True-False-Softmax] correction_term tensor([1.3863])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-True-Softmax] correction_term tensor([1.1921e-07])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[0-False-False-Softmax] correction_term tensor([1.3863])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-True-Softmax] correction_term tensor([-0.])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-True-False-Softmax] correction_term tensor([1.0397])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-True-Softmax] correction_term tensor([5.9605e-08])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[1-False-False-Softmax] correction_term tensor([-0.])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-True-Softmax] correction_term tensor([-0.])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-True-False-Softmax] correction_term tensor([1.0397])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-True-Softmax] correction_term tensor([-0.])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[10-False-False-Softmax] correction_term tensor([-0.])
PASSED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-True-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-True-True-Softmax] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-True-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-True-False-Softmax] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-False-True-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-False-True-Softmax] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-False-False-Gaussian] SKIPPED
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py::TestDegenerateDistribution::test_full_correction_term[None-False-False-Softmax] SKIPPED

=============================== warnings summary ===============================
../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:326
  /local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:326: PytestUnknownMarkWarning: Unknown pytest.mark.async_ - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.async_

../../../../../../local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:333
  /local/data0/moved_data/publishablew/pfrl/pfrl/tests/agents_tests/test_acer.py:333: PytestUnknownMarkWarning: Unknown pytest.mark.async_ - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.async_

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================== 12 passed, 20 skipped, 2 warnings in 1.07s ==================
