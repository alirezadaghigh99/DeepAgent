output file:
processed_scikit-learnfastica108.json
function:
fastica
Error Cases:

Pass or Failed: 0

Related Failed Test Cases:
{'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-arbitrary-variance]', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-False] FAILED', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-unit-variance] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float64-42-False]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-unit-variance]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-arbitrary-variance]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_non_square_fastica[True]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-False]', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-False] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_errors', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float64-42-True]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-False]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-False]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-False]', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-unit-variance] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-arbitrary-variance]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-unit-variance]', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-arbitrary-variance] FAILED', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-arbitrary-variance] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-arbitrary-variance]', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_return_dtypes[float64] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_non_square_fastica[False]', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-False] FAILED', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_non_square_fastica[True] FAILED', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float64-42-True] FAILED', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_non_square_fastica[False] FAILED', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-unit-variance] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_return_dtypes[float64]', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-unit-variance] FAILED', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float64-42-False] FAILED', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_errors FAILED', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-arbitrary-variance] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-unit-variance]', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-arbitrary-variance] FAILED', '../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-False] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-unit-variance]'}

All Test Cases On Generated code:
============================= test session starts ==============================
platform linux -- Python 3.9.0, pytest-8.3.3, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/scikit-learn/scikit-learn/venv/bin/python
cachedir: .pytest_cache
rootdir: /local/data0/moved_data/publishablew/scikit-learn/scikit-learn
configfile: setup.cfg
plugins: cov-6.0.0
collecting ... collected 44 items

../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_gs I: Seeding RNGs with 1008332327
PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_attributes_dtypes[float32] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_attributes_dtypes[float64] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_return_dtypes[float32] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_return_dtypes[float64] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float32-42-True] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float32-42-False] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float64-42-True] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float64-42-False] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_nowhiten PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_convergence_fail PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_non_square_fastica[True] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_non_square_fastica[False] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fit_transform[float32-42] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fit_transform[float64-42] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-arbitrary-variance-5-expected_mixing_shape0] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-arbitrary-variance-10-expected_mixing_shape1] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-unit-variance-5-expected_mixing_shape2] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-unit-variance-10-expected_mixing_shape3] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-False-5-expected_mixing_shape4] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-False-10-expected_mixing_shape5] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-arbitrary-variance-5-expected_mixing_shape0] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-arbitrary-variance-10-expected_mixing_shape1] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-unit-variance-5-expected_mixing_shape2] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-unit-variance-10-expected_mixing_shape3] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-False-5-expected_mixing_shape4] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-False-10-expected_mixing_shape5] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_errors FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_whiten_unit_variance PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-arbitrary-variance] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-unit-variance] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-False] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-arbitrary-variance] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-unit-variance] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-False] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-arbitrary-variance] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-unit-variance] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-False] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-arbitrary-variance] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-unit-variance] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-False] FAILED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple_different_solvers[42-True] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple_different_solvers[42-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_eigh_low_rank_warning[42] PASSED

=================================== FAILURES ===================================
_____________________ test_fastica_return_dtypes[float64] ______________________

args = (array([[5.48813504e-01, 7.15189366e-01, 6.02763376e-01, 5.44883183e-01,
        4.23654799e-01, 6.45894113e-01, 4.375...01,
        7.36853162e-01, 9.76763674e-02, 5.14922202e-01, 9.38412022e-01,
        2.28646551e-01, 6.77141144e-01]]),)
kwargs = {'max_iter': 1000, 'random_state': RandomState(MT19937) at 0x7165641A4040, 'whiten': 'unit-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[5.48813504e-01, 7.15189366e-01, 6.02763376e-01, 5.44883183e-01,
        4.23654799e-01, 6.45894113e-01, ...01,
        2.28646551e-01, 6.77141144e-01]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

global_dtype = <class 'numpy.float64'>

    def test_fastica_return_dtypes(global_dtype):
        rng = np.random.RandomState(0)
        X = rng.random_sample((100, 10)).astype(global_dtype, copy=False)
>       k_, mixing_, s_ = fastica(
            X, max_iter=1000, whiten="unit-variance", random_state=rng
        )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:64: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[5.48813504e-01, 7.15189366e-01, 6.02763376e-01, 5.44883183e-01,
        4.23654799e-01, 6.45894113e-01, 4.375...01,
        7.36853162e-01, 9.76763674e-02, 5.14922202e-01, 9.38412022e-01,
        2.28646551e-01, 6.77141144e-01]]),)
kwargs = {'max_iter': 1000, 'random_state': RandomState(MT19937) at 0x7165641A4040, 'whiten': 'unit-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[5.48813504e-01, 7.15189366e-01, 6.02763376e-01, 5.44883183e-01,
        4.23654799e-01, 6.45894113e-01, ...01,
        2.28646551e-01, 6.77141144e-01]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
_____________________ test_fastica_simple[float64-42-True] _____________________

args = (array([[-0.77421405, -0.44262622],
       [ 0.82038213,  0.62271584],
       [ 1.09332522,  0.26233302],
       ...,
       [-0.76568212, -0.65764402],
       [-0.88574246, -0.59004679],
       [-0.76019433, -0.66180433]]),)
kwargs = {'algorithm': 'parallel', 'fun': 'logcosh', 'random_state': RandomState(MT19937) at 0x7165641A4B40, 'whiten': 'arbitrary-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[-0.77421405, -0.44262622],
       [ 0.82038213,  0.62271584],
       [ 1.09332522,  0.26233302],
       ...9004679],
       [-0.76019433, -0.66180433]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

add_noise = True, global_random_seed = 42
global_dtype = <class 'numpy.float64'>

    @pytest.mark.parametrize("add_noise", [True, False])
    def test_fastica_simple(add_noise, global_random_seed, global_dtype):
        if (
            global_random_seed == 20
            and global_dtype == np.float32
            and not add_noise
            and os.getenv("DISTRIB") == "ubuntu"
        ):
            pytest.xfail(
                "FastICA instability with Ubuntu Atlas build with float32 "
                "global_dtype. For more details, see "
                "https://github.com/scikit-learn/scikit-learn/issues/24131#issuecomment-1208091119"  # noqa
            )
    
        # Test the FastICA algorithm on very simple data.
        rng = np.random.RandomState(global_random_seed)
        n_samples = 1000
        # Generate two sources:
        s1 = (2 * np.sin(np.linspace(0, 100, n_samples)) > 0) - 1
        s2 = stats.t.rvs(1, size=n_samples, random_state=global_random_seed)
        s = np.c_[s1, s2].T
        center_and_norm(s)
        s = s.astype(global_dtype)
        s1, s2 = s
    
        # Mixing angle
        phi = 0.6
        mixing = np.array([[np.cos(phi), np.sin(phi)], [np.sin(phi), -np.cos(phi)]])
        mixing = mixing.astype(global_dtype)
        m = np.dot(mixing, s)
    
        if add_noise:
            m += 0.1 * rng.randn(2, 1000)
    
        center_and_norm(m)
    
        # function as fun arg
        def g_test(x):
            return x**3, (3 * x**2).mean(axis=-1)
    
        algos = ["parallel", "deflation"]
        nls = ["logcosh", "exp", "cube", g_test]
        whitening = ["arbitrary-variance", "unit-variance", False]
        for algo, nl, whiten in itertools.product(algos, nls, whitening):
            if whiten:
>               k_, mixing_, s_ = fastica(
                    m.T, fun=nl, whiten=whiten, algorithm=algo, random_state=rng
                )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:117: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[-0.77421405, -0.44262622],
       [ 0.82038213,  0.62271584],
       [ 1.09332522,  0.26233302],
       ...,
       [-0.76568212, -0.65764402],
       [-0.88574246, -0.59004679],
       [-0.76019433, -0.66180433]]),)
kwargs = {'algorithm': 'parallel', 'fun': 'logcosh', 'random_state': RandomState(MT19937) at 0x7165641A4B40, 'whiten': 'arbitrary-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[-0.77421405, -0.44262622],
       [ 0.82038213,  0.62271584],
       [ 1.09332522,  0.26233302],
       ...9004679],
       [-0.76019433, -0.66180433]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
____________________ test_fastica_simple[float64-42-False] _____________________

args = (array([[-0.827541  , -0.57701868],
       [ 0.84159506,  0.54302587],
       [ 1.03662881,  0.26537075],
       ...,
       [-0.83356141, -0.56844786],
       [-0.83155534, -0.57130376],
       [-0.82112068, -0.5861588 ]]),)
kwargs = {'algorithm': 'parallel', 'fun': 'logcosh', 'random_state': RandomState(MT19937) at 0x7165641A4E40, 'whiten': 'arbitrary-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[-0.827541  , -0.57701868],
       [ 0.84159506,  0.54302587],
       [ 1.03662881,  0.26537075],
       ...7130376],
       [-0.82112068, -0.5861588 ]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

add_noise = False, global_random_seed = 42
global_dtype = <class 'numpy.float64'>

    @pytest.mark.parametrize("add_noise", [True, False])
    def test_fastica_simple(add_noise, global_random_seed, global_dtype):
        if (
            global_random_seed == 20
            and global_dtype == np.float32
            and not add_noise
            and os.getenv("DISTRIB") == "ubuntu"
        ):
            pytest.xfail(
                "FastICA instability with Ubuntu Atlas build with float32 "
                "global_dtype. For more details, see "
                "https://github.com/scikit-learn/scikit-learn/issues/24131#issuecomment-1208091119"  # noqa
            )
    
        # Test the FastICA algorithm on very simple data.
        rng = np.random.RandomState(global_random_seed)
        n_samples = 1000
        # Generate two sources:
        s1 = (2 * np.sin(np.linspace(0, 100, n_samples)) > 0) - 1
        s2 = stats.t.rvs(1, size=n_samples, random_state=global_random_seed)
        s = np.c_[s1, s2].T
        center_and_norm(s)
        s = s.astype(global_dtype)
        s1, s2 = s
    
        # Mixing angle
        phi = 0.6
        mixing = np.array([[np.cos(phi), np.sin(phi)], [np.sin(phi), -np.cos(phi)]])
        mixing = mixing.astype(global_dtype)
        m = np.dot(mixing, s)
    
        if add_noise:
            m += 0.1 * rng.randn(2, 1000)
    
        center_and_norm(m)
    
        # function as fun arg
        def g_test(x):
            return x**3, (3 * x**2).mean(axis=-1)
    
        algos = ["parallel", "deflation"]
        nls = ["logcosh", "exp", "cube", g_test]
        whitening = ["arbitrary-variance", "unit-variance", False]
        for algo, nl, whiten in itertools.product(algos, nls, whitening):
            if whiten:
>               k_, mixing_, s_ = fastica(
                    m.T, fun=nl, whiten=whiten, algorithm=algo, random_state=rng
                )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:117: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[-0.827541  , -0.57701868],
       [ 0.84159506,  0.54302587],
       [ 1.03662881,  0.26537075],
       ...,
       [-0.83356141, -0.56844786],
       [-0.83155534, -0.57130376],
       [-0.82112068, -0.5861588 ]]),)
kwargs = {'algorithm': 'parallel', 'fun': 'logcosh', 'random_state': RandomState(MT19937) at 0x7165641A4E40, 'whiten': 'arbitrary-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[-0.827541  , -0.57701868],
       [ 0.84159506,  0.54302587],
       [ 1.03662881,  0.26537075],
       ...7130376],
       [-0.82112068, -0.5861588 ]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
________________________ test_non_square_fastica[True] _________________________

args = (array([[-0.17730298, -0.91034658,  0.49486058,  0.15670471, -0.91730373,
        -0.98203982],
       [ 0.36598119,  ...        -1.08273881],
       [-0.38098599,  0.58863834, -1.11380021, -0.92497723,  0.97199087,
         0.97730603]]),)
kwargs = {'n_components': 2, 'random_state': RandomState(MT19937) at 0x716563FF7A40, 'whiten': 'unit-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[-0.17730298, -0.91034658,  0.49486058,  0.15670471, -0.91730373,
        -0.98203982],
       [ 0.365981...92497723,  0.97199087,
         0.97730603]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

add_noise = True

    @pytest.mark.parametrize("add_noise", [True, False])
    def test_non_square_fastica(add_noise):
        # Test the FastICA algorithm on very simple data.
        rng = np.random.RandomState(0)
    
        n_samples = 1000
        # Generate two sources:
        t = np.linspace(0, 100, n_samples)
        s1 = np.sin(t)
        s2 = np.ceil(np.sin(np.pi * t))
        s = np.c_[s1, s2].T
        center_and_norm(s)
        s1, s2 = s
    
        # Mixing matrix
        mixing = rng.randn(6, 2)
        m = np.dot(mixing, s)
    
        if add_noise:
            m += 0.1 * rng.randn(6, n_samples)
    
        center_and_norm(m)
    
>       k_, mixing_, s_ = fastica(
            m.T, n_components=2, whiten="unit-variance", random_state=rng
        )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:244: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[-0.17730298, -0.91034658,  0.49486058,  0.15670471, -0.91730373,
        -0.98203982],
       [ 0.36598119,  ...        -1.08273881],
       [-0.38098599,  0.58863834, -1.11380021, -0.92497723,  0.97199087,
         0.97730603]]),)
kwargs = {'n_components': 2, 'random_state': RandomState(MT19937) at 0x716563FF7A40, 'whiten': 'unit-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[-0.17730298, -0.91034658,  0.49486058,  0.15670471, -0.91730373,
        -0.98203982],
       [ 0.365981...92497723,  0.97199087,
         0.97730603]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
________________________ test_non_square_fastica[False] ________________________

args = (array([[-0.22267876, -0.91644941,  0.46257822,  0.15580421, -0.96984176,
        -0.99511531],
       [ 0.35711866,  ...        -1.07719641],
       [-0.47725596,  0.62925823, -1.09918914, -0.86504474,  1.14496057,
         0.92435813]]),)
kwargs = {'n_components': 2, 'random_state': RandomState(MT19937) at 0x716563FF7440, 'whiten': 'unit-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[-0.22267876, -0.91644941,  0.46257822,  0.15580421, -0.96984176,
        -0.99511531],
       [ 0.357118...86504474,  1.14496057,
         0.92435813]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

add_noise = False

    @pytest.mark.parametrize("add_noise", [True, False])
    def test_non_square_fastica(add_noise):
        # Test the FastICA algorithm on very simple data.
        rng = np.random.RandomState(0)
    
        n_samples = 1000
        # Generate two sources:
        t = np.linspace(0, 100, n_samples)
        s1 = np.sin(t)
        s2 = np.ceil(np.sin(np.pi * t))
        s = np.c_[s1, s2].T
        center_and_norm(s)
        s1, s2 = s
    
        # Mixing matrix
        mixing = rng.randn(6, 2)
        m = np.dot(mixing, s)
    
        if add_noise:
            m += 0.1 * rng.randn(6, n_samples)
    
        center_and_norm(m)
    
>       k_, mixing_, s_ = fastica(
            m.T, n_components=2, whiten="unit-variance", random_state=rng
        )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:244: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[-0.22267876, -0.91644941,  0.46257822,  0.15580421, -0.96984176,
        -0.99511531],
       [ 0.35711866,  ...        -1.07719641],
       [-0.47725596,  0.62925823, -1.09918914, -0.86504474,  1.14496057,
         0.92435813]]),)
kwargs = {'n_components': 2, 'random_state': RandomState(MT19937) at 0x716563FF7440, 'whiten': 'unit-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[-0.22267876, -0.91644941,  0.46257822,  0.15580421, -0.96984176,
        -0.99511531],
       [ 0.357118...86504474,  1.14496057,
         0.92435813]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
_____________________________ test_fastica_errors ______________________________

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'fun_args': {'alpha': 0}}, global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

    def test_fastica_errors():
        n_features = 3
        n_samples = 10
        rng = np.random.RandomState(0)
        X = rng.random_sample((n_samples, n_features))
        w_init = rng.randn(n_features + 1, n_features + 1)
        with pytest.raises(ValueError, match=r"alpha must be in \[1,2\]"):
>           fastica(X, fun_args={"alpha": 0})

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:368: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'fun_args': {'alpha': 0}}, global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError

During handling of the above exception, another exception occurred:

    def test_fastica_errors():
        n_features = 3
        n_samples = 10
        rng = np.random.RandomState(0)
        X = rng.random_sample((n_samples, n_features))
        w_init = rng.randn(n_features + 1, n_features + 1)
        with pytest.raises(ValueError, match=r"alpha must be in \[1,2\]"):
>           fastica(X, fun_args={"alpha": 0})
E           AssertionError: Regex pattern did not match.
E            Regex: 'alpha must be in \\[1,2\\]'
E            Input: "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:368: AssertionError
___________ test_fastica_output_shape[True-True-arbitrary-variance] ____________

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': True, 'return_n_iter': True, 'whiten': 'arbitrary-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

whiten = 'arbitrary-variance', return_X_mean = True, return_n_iter = True

    @pytest.mark.parametrize("whiten", ["arbitrary-variance", "unit-variance", False])
    @pytest.mark.parametrize("return_X_mean", [True, False])
    @pytest.mark.parametrize("return_n_iter", [True, False])
    def test_fastica_output_shape(whiten, return_X_mean, return_n_iter):
        n_features = 3
        n_samples = 10
        rng = np.random.RandomState(0)
        X = rng.random_sample((n_samples, n_features))
    
        expected_len = 3 + return_X_mean + return_n_iter
    
>       out = fastica(
            X, whiten=whiten, return_n_iter=return_n_iter, return_X_mean=return_X_mean
        )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:400: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': True, 'return_n_iter': True, 'whiten': 'arbitrary-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
______________ test_fastica_output_shape[True-True-unit-variance] ______________

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': True, 'return_n_iter': True, 'whiten': 'unit-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

whiten = 'unit-variance', return_X_mean = True, return_n_iter = True

    @pytest.mark.parametrize("whiten", ["arbitrary-variance", "unit-variance", False])
    @pytest.mark.parametrize("return_X_mean", [True, False])
    @pytest.mark.parametrize("return_n_iter", [True, False])
    def test_fastica_output_shape(whiten, return_X_mean, return_n_iter):
        n_features = 3
        n_samples = 10
        rng = np.random.RandomState(0)
        X = rng.random_sample((n_samples, n_features))
    
        expected_len = 3 + return_X_mean + return_n_iter
    
>       out = fastica(
            X, whiten=whiten, return_n_iter=return_n_iter, return_X_mean=return_X_mean
        )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:400: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': True, 'return_n_iter': True, 'whiten': 'unit-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
__________________ test_fastica_output_shape[True-True-False] __________________

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': True, 'return_n_iter': True, 'whiten': False}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

whiten = False, return_X_mean = True, return_n_iter = True

    @pytest.mark.parametrize("whiten", ["arbitrary-variance", "unit-variance", False])
    @pytest.mark.parametrize("return_X_mean", [True, False])
    @pytest.mark.parametrize("return_n_iter", [True, False])
    def test_fastica_output_shape(whiten, return_X_mean, return_n_iter):
        n_features = 3
        n_samples = 10
        rng = np.random.RandomState(0)
        X = rng.random_sample((n_samples, n_features))
    
        expected_len = 3 + return_X_mean + return_n_iter
    
>       out = fastica(
            X, whiten=whiten, return_n_iter=return_n_iter, return_X_mean=return_X_mean
        )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:400: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': True, 'return_n_iter': True, 'whiten': False}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
___________ test_fastica_output_shape[True-False-arbitrary-variance] ___________

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': False, 'return_n_iter': True, 'whiten': 'arbitrary-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

whiten = 'arbitrary-variance', return_X_mean = False, return_n_iter = True

    @pytest.mark.parametrize("whiten", ["arbitrary-variance", "unit-variance", False])
    @pytest.mark.parametrize("return_X_mean", [True, False])
    @pytest.mark.parametrize("return_n_iter", [True, False])
    def test_fastica_output_shape(whiten, return_X_mean, return_n_iter):
        n_features = 3
        n_samples = 10
        rng = np.random.RandomState(0)
        X = rng.random_sample((n_samples, n_features))
    
        expected_len = 3 + return_X_mean + return_n_iter
    
>       out = fastica(
            X, whiten=whiten, return_n_iter=return_n_iter, return_X_mean=return_X_mean
        )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:400: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': False, 'return_n_iter': True, 'whiten': 'arbitrary-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
_____________ test_fastica_output_shape[True-False-unit-variance] ______________

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': False, 'return_n_iter': True, 'whiten': 'unit-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

whiten = 'unit-variance', return_X_mean = False, return_n_iter = True

    @pytest.mark.parametrize("whiten", ["arbitrary-variance", "unit-variance", False])
    @pytest.mark.parametrize("return_X_mean", [True, False])
    @pytest.mark.parametrize("return_n_iter", [True, False])
    def test_fastica_output_shape(whiten, return_X_mean, return_n_iter):
        n_features = 3
        n_samples = 10
        rng = np.random.RandomState(0)
        X = rng.random_sample((n_samples, n_features))
    
        expected_len = 3 + return_X_mean + return_n_iter
    
>       out = fastica(
            X, whiten=whiten, return_n_iter=return_n_iter, return_X_mean=return_X_mean
        )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:400: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': False, 'return_n_iter': True, 'whiten': 'unit-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
_________________ test_fastica_output_shape[True-False-False] __________________

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': False, 'return_n_iter': True, 'whiten': False}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

whiten = False, return_X_mean = False, return_n_iter = True

    @pytest.mark.parametrize("whiten", ["arbitrary-variance", "unit-variance", False])
    @pytest.mark.parametrize("return_X_mean", [True, False])
    @pytest.mark.parametrize("return_n_iter", [True, False])
    def test_fastica_output_shape(whiten, return_X_mean, return_n_iter):
        n_features = 3
        n_samples = 10
        rng = np.random.RandomState(0)
        X = rng.random_sample((n_samples, n_features))
    
        expected_len = 3 + return_X_mean + return_n_iter
    
>       out = fastica(
            X, whiten=whiten, return_n_iter=return_n_iter, return_X_mean=return_X_mean
        )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:400: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': False, 'return_n_iter': True, 'whiten': False}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
___________ test_fastica_output_shape[False-True-arbitrary-variance] ___________

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': True, 'return_n_iter': False, 'whiten': 'arbitrary-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

whiten = 'arbitrary-variance', return_X_mean = True, return_n_iter = False

    @pytest.mark.parametrize("whiten", ["arbitrary-variance", "unit-variance", False])
    @pytest.mark.parametrize("return_X_mean", [True, False])
    @pytest.mark.parametrize("return_n_iter", [True, False])
    def test_fastica_output_shape(whiten, return_X_mean, return_n_iter):
        n_features = 3
        n_samples = 10
        rng = np.random.RandomState(0)
        X = rng.random_sample((n_samples, n_features))
    
        expected_len = 3 + return_X_mean + return_n_iter
    
>       out = fastica(
            X, whiten=whiten, return_n_iter=return_n_iter, return_X_mean=return_X_mean
        )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:400: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': True, 'return_n_iter': False, 'whiten': 'arbitrary-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
_____________ test_fastica_output_shape[False-True-unit-variance] ______________

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': True, 'return_n_iter': False, 'whiten': 'unit-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

whiten = 'unit-variance', return_X_mean = True, return_n_iter = False

    @pytest.mark.parametrize("whiten", ["arbitrary-variance", "unit-variance", False])
    @pytest.mark.parametrize("return_X_mean", [True, False])
    @pytest.mark.parametrize("return_n_iter", [True, False])
    def test_fastica_output_shape(whiten, return_X_mean, return_n_iter):
        n_features = 3
        n_samples = 10
        rng = np.random.RandomState(0)
        X = rng.random_sample((n_samples, n_features))
    
        expected_len = 3 + return_X_mean + return_n_iter
    
>       out = fastica(
            X, whiten=whiten, return_n_iter=return_n_iter, return_X_mean=return_X_mean
        )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:400: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': True, 'return_n_iter': False, 'whiten': 'unit-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
_________________ test_fastica_output_shape[False-True-False] __________________

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': True, 'return_n_iter': False, 'whiten': False}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

whiten = False, return_X_mean = True, return_n_iter = False

    @pytest.mark.parametrize("whiten", ["arbitrary-variance", "unit-variance", False])
    @pytest.mark.parametrize("return_X_mean", [True, False])
    @pytest.mark.parametrize("return_n_iter", [True, False])
    def test_fastica_output_shape(whiten, return_X_mean, return_n_iter):
        n_features = 3
        n_samples = 10
        rng = np.random.RandomState(0)
        X = rng.random_sample((n_samples, n_features))
    
        expected_len = 3 + return_X_mean + return_n_iter
    
>       out = fastica(
            X, whiten=whiten, return_n_iter=return_n_iter, return_X_mean=return_X_mean
        )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:400: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': True, 'return_n_iter': False, 'whiten': False}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
__________ test_fastica_output_shape[False-False-arbitrary-variance] ___________

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': False, 'return_n_iter': False, 'whiten': 'arbitrary-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

whiten = 'arbitrary-variance', return_X_mean = False, return_n_iter = False

    @pytest.mark.parametrize("whiten", ["arbitrary-variance", "unit-variance", False])
    @pytest.mark.parametrize("return_X_mean", [True, False])
    @pytest.mark.parametrize("return_n_iter", [True, False])
    def test_fastica_output_shape(whiten, return_X_mean, return_n_iter):
        n_features = 3
        n_samples = 10
        rng = np.random.RandomState(0)
        X = rng.random_sample((n_samples, n_features))
    
        expected_len = 3 + return_X_mean + return_n_iter
    
>       out = fastica(
            X, whiten=whiten, return_n_iter=return_n_iter, return_X_mean=return_X_mean
        )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:400: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': False, 'return_n_iter': False, 'whiten': 'arbitrary-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
_____________ test_fastica_output_shape[False-False-unit-variance] _____________

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': False, 'return_n_iter': False, 'whiten': 'unit-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

whiten = 'unit-variance', return_X_mean = False, return_n_iter = False

    @pytest.mark.parametrize("whiten", ["arbitrary-variance", "unit-variance", False])
    @pytest.mark.parametrize("return_X_mean", [True, False])
    @pytest.mark.parametrize("return_n_iter", [True, False])
    def test_fastica_output_shape(whiten, return_X_mean, return_n_iter):
        n_features = 3
        n_samples = 10
        rng = np.random.RandomState(0)
        X = rng.random_sample((n_samples, n_features))
    
        expected_len = 3 + return_X_mean + return_n_iter
    
>       out = fastica(
            X, whiten=whiten, return_n_iter=return_n_iter, return_X_mean=return_X_mean
        )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:400: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': False, 'return_n_iter': False, 'whiten': 'unit-variance'}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
_________________ test_fastica_output_shape[False-False-False] _________________

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': False, 'return_n_iter': False, 'whiten': False}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
>               return func(*args, **kwargs)

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:216: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/_fastica.py:116: in fastica
    return fastica(X, n_components)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/temp.py:48: in fastica
    S = ica.fit_transform(X) if compute_sources else None
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_set_output.py:319: in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:1323: in wrapper
    estimator._validate_params()
/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/base.py:406: in _validate_params
    validate_parameter_constraints(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

parameter_constraints = {'algorithm': [<sklearn.utils._param_validation.StrOptions object at 0x716569230940>], 'fun': [<sklearn.utils._param_v..._args': [<class 'dict'>, None], 'max_iter': [<sklearn.utils._param_validation.Interval object at 0x7165692309a0>], ...}
params = {'algorithm': 'parallel', 'fun': 'logcosh', 'fun_args': None, 'max_iter': 200, ...}
caller_name = 'FastICA'

    def validate_parameter_constraints(parameter_constraints, params, caller_name):
        """Validate types and values of given parameters.
    
        Parameters
        ----------
        parameter_constraints : dict or {"no_validation"}
            If "no_validation", validation is skipped for this parameter.
    
            If a dict, it must be a dictionary `param_name: list of constraints`.
            A parameter is valid if it satisfies one of the constraints from the list.
            Constraints can be:
            - an Interval object, representing a continuous or discrete range of numbers
            - the string "array-like"
            - the string "sparse matrix"
            - the string "random_state"
            - callable
            - None, meaning that None is a valid value for the parameter
            - any type, meaning that any instance of this type is valid
            - an Options object, representing a set of elements of a given type
            - a StrOptions object, representing a set of strings
            - the string "boolean"
            - the string "verbose"
            - the string "cv_object"
            - the string "nan"
            - a MissingValues object representing markers for missing values
            - a HasMethods object, representing method(s) an object must have
            - a Hidden object, representing a constraint not meant to be exposed to the user
    
        params : dict
            A dictionary `param_name: param_value`. The parameters to validate against the
            constraints.
    
        caller_name : str
            The name of the estimator or function or method that called this function.
        """
        for param_name, param_val in params.items():
            # We allow parameters to not have a constraint so that third party estimators
            # can inherit from sklearn estimators without having to necessarily use the
            # validation tools.
            if param_name not in parameter_constraints:
                continue
    
            constraints = parameter_constraints[param_name]
    
            if constraints == "no_validation":
                continue
    
            constraints = [make_constraint(constraint) for constraint in constraints]
    
            for constraint in constraints:
                if constraint.is_satisfied_by(param_val):
                    # this constraint is satisfied, no need to check further.
                    break
            else:
                # No constraint is satisfied, raise with an informative message.
    
                # Ignore constraints that we don't want to expose in the error message,
                # i.e. options that are for internal purpose or not officially supported.
                constraints = [
                    constraint for constraint in constraints if not constraint.hidden
                ]
    
                if len(constraints) == 1:
                    constraints_str = f"{constraints[0]}"
                else:
                    constraints_str = (
                        f"{', '.join([str(c) for c in constraints[:-1]])} or"
                        f" {constraints[-1]}"
                    )
    
>               raise InvalidParameterError(
                    f"The {param_name!r} parameter of {caller_name} must be"
                    f" {constraints_str}. Got {param_val!r} instead."
                )
E               sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of FastICA must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:98: InvalidParameterError

The above exception was the direct cause of the following exception:

whiten = False, return_X_mean = False, return_n_iter = False

    @pytest.mark.parametrize("whiten", ["arbitrary-variance", "unit-variance", False])
    @pytest.mark.parametrize("return_X_mean", [True, False])
    @pytest.mark.parametrize("return_n_iter", [True, False])
    def test_fastica_output_shape(whiten, return_X_mean, return_n_iter):
        n_features = 3
        n_samples = 10
        rng = np.random.RandomState(0)
        X = rng.random_sample((n_samples, n_features))
    
        expected_len = 3 + return_X_mean + return_n_iter
    
>       out = fastica(
            X, whiten=whiten, return_n_iter=return_n_iter, return_X_mean=return_X_mean
        )

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py:400: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0.89177..., 0.46147936, 0.78052918],
       [0.11827443, 0.63992102, 0.14335329],
       [0.94466892, 0.52184832, 0.41466194]]),)
kwargs = {'return_X_mean': False, 'return_n_iter': False, 'whiten': False}
global_skip_validation = False
func_sig = <Signature (X, n_components=None, *, algorithm='parallel', whiten='unit-variance', fun='logcosh', fun_args=None, max_i..., w_init=None, whiten_solver='svd', random_state=None, return_X_mean=False, compute_sources=True, return_n_iter=False)>
params = {'X': array([[0.5488135 , 0.71518937, 0.60276338],
       [0.54488318, 0.4236548 , 0.64589411],
       [0.43758721, 0....       [0.94466892, 0.52184832, 0.41466194]]), 'algorithm': 'parallel', 'compute_sources': True, 'fun': 'logcosh', ...}
msg = "The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead."

    @functools.wraps(func)
    def wrapper(*args, **kwargs):
        global_skip_validation = get_config()["skip_parameter_validation"]
        if global_skip_validation:
            return func(*args, **kwargs)
    
        func_sig = signature(func)
    
        # Map *args/**kwargs to the function signature
        params = func_sig.bind(*args, **kwargs)
        params.apply_defaults()
    
        # ignore self/cls and positional/keyword markers
        to_ignore = [
            p.name
            for p in func_sig.parameters.values()
            if p.kind in (p.VAR_POSITIONAL, p.VAR_KEYWORD)
        ]
        to_ignore += ["self", "cls"]
        params = {k: v for k, v in params.arguments.items() if k not in to_ignore}
    
        validate_parameter_constraints(
            parameter_constraints, params, caller_name=func.__qualname__
        )
    
        try:
            with config_context(
                skip_parameter_validation=(
                    prefer_skip_nested_validation or global_skip_validation
                )
            ):
                return func(*args, **kwargs)
        except InvalidParameterError as e:
            # When the function is just a wrapper around an estimator, we allow
            # the function to delegate validation to the estimator, but we replace
            # the name of the estimator by the name of the function in the error
            # message to avoid confusion.
            msg = re.sub(
                r"parameter of \w+ must be",
                f"parameter of {func.__qualname__} must be",
                str(e),
            )
>           raise InvalidParameterError(msg) from e
E           sklearn.utils._param_validation.InvalidParameterError: The 'whiten' parameter of fastica must be a str among {'arbitrary-variance', 'unit-variance'} or a bool among {False}. Got True instead.

/local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/utils/_param_validation.py:227: InvalidParameterError
=========================== short test summary info ============================
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_return_dtypes[float64]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float64-42-True]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float64-42-False]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_non_square_fastica[True]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_non_square_fastica[False]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_errors
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-arbitrary-variance]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-unit-variance]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-False]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-arbitrary-variance]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-unit-variance]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-False]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-arbitrary-variance]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-unit-variance]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-False]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-arbitrary-variance]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-unit-variance]
FAILED ../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-False]
================== 18 failed, 15 passed, 11 skipped in 1.12s ===================


Final Test Result:
============================= test session starts ==============================
platform linux -- Python 3.9.0, pytest-8.3.3, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/scikit-learn/scikit-learn/venv/bin/python
cachedir: .pytest_cache
rootdir: /local/data0/moved_data/publishablew/scikit-learn/scikit-learn
configfile: setup.cfg
plugins: cov-6.0.0
collecting ... collected 44 items

../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_gs I: Seeding RNGs with 1349391517
PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_attributes_dtypes[float32] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_attributes_dtypes[float64] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_return_dtypes[float32] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_return_dtypes[float64] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float32-42-True] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float32-42-False] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float64-42-True] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float64-42-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_nowhiten PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_convergence_fail PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_non_square_fastica[True] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_non_square_fastica[False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fit_transform[float32-42] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fit_transform[float64-42] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-arbitrary-variance-5-expected_mixing_shape0] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-arbitrary-variance-10-expected_mixing_shape1] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-unit-variance-5-expected_mixing_shape2] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-unit-variance-10-expected_mixing_shape3] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-False-5-expected_mixing_shape4] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-False-10-expected_mixing_shape5] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-arbitrary-variance-5-expected_mixing_shape0] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-arbitrary-variance-10-expected_mixing_shape1] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-unit-variance-5-expected_mixing_shape2] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-unit-variance-10-expected_mixing_shape3] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-False-5-expected_mixing_shape4] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-False-10-expected_mixing_shape5] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_errors PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_whiten_unit_variance PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-arbitrary-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-unit-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-arbitrary-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-unit-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-arbitrary-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-unit-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-arbitrary-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-unit-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple_different_solvers[42-True] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple_different_solvers[42-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_eigh_low_rank_warning[42] PASSED

======================== 33 passed, 11 skipped in 0.49s ========================


Initial Result:
============================= test session starts ==============================
platform linux -- Python 3.9.0, pytest-8.3.3, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/scikit-learn/scikit-learn/venv/bin/python
cachedir: .pytest_cache
rootdir: /local/data0/moved_data/publishablew/scikit-learn/scikit-learn
configfile: setup.cfg
plugins: cov-6.0.0
collecting ... collected 44 items

../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_gs I: Seeding RNGs with 555145298
PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_attributes_dtypes[float32] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_attributes_dtypes[float64] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_return_dtypes[float32] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_return_dtypes[float64] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float32-42-True] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float32-42-False] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float64-42-True] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple[float64-42-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_nowhiten PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_convergence_fail PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_non_square_fastica[True] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_non_square_fastica[False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fit_transform[float32-42] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fit_transform[float64-42] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-arbitrary-variance-5-expected_mixing_shape0] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-arbitrary-variance-10-expected_mixing_shape1] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-unit-variance-5-expected_mixing_shape2] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-unit-variance-10-expected_mixing_shape3] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-False-5-expected_mixing_shape4] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float32-42-False-10-expected_mixing_shape5] SKIPPED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-arbitrary-variance-5-expected_mixing_shape0] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-arbitrary-variance-10-expected_mixing_shape1] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-unit-variance-5-expected_mixing_shape2] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-unit-variance-10-expected_mixing_shape3] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-False-5-expected_mixing_shape4] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_inverse_transform[float64-42-False-10-expected_mixing_shape5] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_errors PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_whiten_unit_variance PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-arbitrary-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-unit-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-arbitrary-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-unit-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[True-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-arbitrary-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-unit-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-arbitrary-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-unit-variance] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_output_shape[False-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple_different_solvers[42-True] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_simple_different_solvers[42-False] PASSED
../../../../../../local/data0/moved_data/publishablew/scikit-learn/scikit-learn/sklearn/decomposition/tests/test_fastica.py::test_fastica_eigh_low_rank_warning[42] PASSED

======================== 33 passed, 11 skipped in 0.50s ========================
