output file:
processed_cleanlabestimate_latent180.json
function:
estimate_latent
Error Cases:

number of examples processed for estimating thresholds:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for estimating thresholds: 100%|██████████| 160/160 [00:00<00:00, 595464.63it/s]

number of examples processed for checking labels:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for checking labels: 100%|██████████| 160/160 [00:00<00:00, 883011.37it/s]

number of examples processed for estimating thresholds:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for estimating thresholds: 100%|██████████| 160/160 [00:00<00:00, 1055170.82it/s]

number of examples processed for checking labels:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for checking labels: 100%|██████████| 160/160 [00:00<00:00, 856.85it/s]
number of examples processed for checking labels: 100%|██████████| 160/160 [00:00<00:00, 855.61it/s]

number of examples processed for estimating thresholds:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for estimating thresholds: 260it [00:00, 1359749.43it/s]          

number of examples processed for checking labels:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for checking labels: 260it [00:00, 7615.14it/s]             

number of examples processed for estimating thresholds:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for estimating thresholds: 100%|██████████| 160/160 [00:00<00:00, 27539.75it/s]

number of examples processed for checking labels:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for checking labels: 100%|██████████| 160/160 [00:00<00:00, 37897.48it/s]

number of examples processed for estimating thresholds:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for estimating thresholds: 100%|██████████| 160/160 [00:00<00:00, 1539194.13it/s]

number of examples processed for checking labels:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for checking labels: 100%|██████████| 160/160 [00:00<00:00, 2338287.94it/s]

number of examples processed for estimating thresholds:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for estimating thresholds: 100%|██████████| 160/160 [00:00<00:00, 1885080.45it/s]

number of examples processed for checking labels:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for checking labels: 100%|██████████| 160/160 [00:00<00:00, 2513440.60it/s]

number of examples processed for estimating thresholds:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for estimating thresholds: 100%|██████████| 160/160 [00:00<00:00, 646520.85it/s]

number of examples processed for checking labels:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for checking labels: 100%|██████████| 160/160 [00:00<00:00, 407461.23it/s]

number of examples processed for estimating thresholds:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for estimating thresholds: 100%|██████████| 160/160 [00:00<00:00, 1045309.41it/s]

number of examples processed for checking labels:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for checking labels: 100%|██████████| 160/160 [00:00<00:00, 852.57it/s]
number of examples processed for checking labels: 100%|██████████| 160/160 [00:00<00:00, 851.60it/s]

number of examples processed for estimating thresholds:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for estimating thresholds: 260it [00:00, 1529479.72it/s]          

number of examples processed for checking labels:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for checking labels: 260it [00:00, 7647.99it/s]             

number of examples processed for estimating thresholds:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for estimating thresholds: 100%|██████████| 160/160 [00:00<00:00, 1003122.03it/s]

number of examples processed for checking labels:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for checking labels: 100%|██████████| 160/160 [00:00<00:00, 950550.48it/s]

number of examples processed for estimating thresholds:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for estimating thresholds: 100%|██████████| 160/160 [00:00<00:00, 505337.83it/s]

number of examples processed for checking labels:   0%|          | 0/160 [00:00<?, ?it/s]
number of examples processed for checking labels: 100%|██████████| 160/160 [00:00<00:00, 715446.31it/s]

Pass or Failed: 0

Related Failed Test Cases:
{'FAILED ../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_noise_matrices[True]', '../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_latent_converge FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_noise_matrices[False]', 'FAILED ../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_py_and_noise_matrices_missing_classes', '../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_noise_matrices[False] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_latent_converge', '../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_noise_matrices[True] FAILED', 'FAILED ../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_issue_158', '../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_py_and_noise_matrices_missing_classes FAILED', '../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_issue_158 FAILED'}

All Test Cases On Generated code:
============================= test session starts ==============================
platform linux -- Python 3.11.10, pytest-8.3.4, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/cleanlab/cleanlab/venv/bin/python
cachedir: .pytest_cache
hypothesis profile 'default' -> database=DirectoryBasedExampleDatabase(PosixPath('/home/aliredaq/Desktop/ICSE/src/tester/.hypothesis/examples'))
rootdir: /local/data0/moved_data/publishablew/cleanlab/cleanlab
configfile: pyproject.toml
plugins: hypothesis-6.124.1
collecting ... collected 135 items

../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_exact_prune_count PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_both[None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_both[1] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_both[2] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_prune_on_small_data[prune_by_noise_rate] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_prune_on_small_data[prune_by_class] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_prune_on_small_data[both] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_prune_on_small_data[confident_learning] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_prune_on_small_data[predicted_neq_given] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_calibrate_joint PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_calibrate_joint_multilabel PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_joint[True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_joint[False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_joint_multilabel PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confidence_thresholds PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confidence_thresholds_multilabel PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_compute_confident_joint PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_latent_py_method PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_latent_converge FAILED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_noise_matrices[True] FAILED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_noise_matrices[False] FAILED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_reduce_prune_counts PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_keep_at_least_n_per_class PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_order_method PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_noise_rate-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_noise_rate-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_noise_rate-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_noise_rate-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_class-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_class-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_class-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_class-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-both-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-both-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-both-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-both-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-confident_learning-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-confident_learning-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-confident_learning-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-confident_learning-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_noise_rate-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_noise_rate-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_noise_rate-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_noise_rate-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_class-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_class-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_class-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_class-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-both-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-both-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-both-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-both-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-confident_learning-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-confident_learning-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-confident_learning-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-confident_learning-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_noise_rate-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_noise_rate-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_noise_rate-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_noise_rate-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_class-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_class-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_class-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_class-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-both-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-both-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-both-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-both-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-confident_learning-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-confident_learning-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-confident_learning-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-confident_learning-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_noise_rate-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_noise_rate-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_noise_rate-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_noise_rate-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_class-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_class-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_class-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_class-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-both-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-both-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-both-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-both-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-confident_learning-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-confident_learning-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-confident_learning-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-confident_learning-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[None-None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[None-confident_joint1] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[None-confident_joint2] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[self_confidence-None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[self_confidence-confident_joint1] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[self_confidence-confident_joint2] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[normalized_margin-None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[normalized_margin-confident_joint1] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[normalized_margin-confident_joint2] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[confidence_weighted_entropy-None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[confidence_weighted_entropy-confident_joint1] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[confidence_weighted_entropy-confident_joint2] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confident_learning_filter[True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confident_learning_filter[False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confident_learning_filter_multilabel[True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confident_learning_filter_multilabel[False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_predicted_neq_given_filter PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_predicted_neq_given_filter_multilabel PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[prune_by_noise_rate-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[prune_by_noise_rate-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[prune_by_class-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[prune_by_class-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[both-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[both-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issue_filters_match_origin_functions Number of label issues found: 1
PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_num_label_issues_different_estimation_types PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_same_value PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_num_label_issues PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_num_label_issues_multilabel[None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_num_label_issues_multilabel[True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_batched_label_issues Total number of examples whose labels have been evaluated: 160
Multiprocessing will default to using the number of logical cores (16). To default to number of physical cores: pip install psutil
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Multiprocessing will default to using the number of logical cores (16). To default to number of physical cores: pip install psutil
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
mmap-loaded numpy arrays have: 160 examples, 3 classes
Total number of examples whose labels have been evaluated: 160
PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_issue_158 FAILED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_missing_classes PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_match_multiprocessing PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_missing_classes_multilabel[None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_missing_classes_multilabel[self_confidence] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_missing_classes_multilabel[normalized_margin] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_missing_classes_multilabel[confidence_weighted_entropy] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_removing_class_consistent_results PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_py_and_noise_matrices_missing_classes FAILED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_low_filter_by_methods PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_low_filter_by_methods_multilabel PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_does_not_flag_correct_examples[prune_by_noise_rate] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_does_not_flag_correct_examples[prune_by_class] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_does_not_flag_correct_examples[both] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_does_not_flag_correct_examples[confident_learning] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_does_not_flag_correct_examples[predicted_neq_given] PASSED

=================================== FAILURES ===================================
________________________ test_estimate_latent_converge _________________________

    def test_estimate_latent_converge():
        py, nm, inv = count.estimate_latent(
            confident_joint=data["cj"],
            labels=data["labels"],
            converge_latent_estimates=True,
        )
    
        py2, nm2, inv2 = count.estimate_latent(
            confident_joint=data["cj"],
            labels=data["labels"],
            converge_latent_estimates=False,
        )
        # Check results are similar, but not the same.
>       assert np.any(inv != inv2)
E       assert False
E        +  where False = <function any at 0x747329bdbe30>(array([[ 1.47918168, -0.13262562, -0.2923177 ],\n       [-0.276816  ,  1.21878131, -0.06880855],\n       [-0.20236568, -0.08615568,  1.36112625]]) != array([[ 1.47918168, -0.13262562, -0.2923177 ],\n       [-0.276816  ,  1.21878131, -0.06880855],\n       [-0.20236568, -0.08615568,  1.36112625]]))
E        +    where <function any at 0x747329bdbe30> = np.any

/local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py:438: AssertionError
______________________ test_estimate_noise_matrices[True] ______________________

sparse = True

    @pytest.mark.parametrize("sparse", [True, False])
    def test_estimate_noise_matrices(sparse):
        data = make_data(sparse=sparse, seed=seed)
        nm, inv = count.estimate_noise_matrices(
            X=data["X_train"],
            labels=data["labels"],
        )
        assert np.all(abs(nm - data["est_nm"]) < 0.1)
>       assert np.all(abs(inv - data["est_inv"]) < 0.1)
E       assert False
E        +  where False = <function all at 0x747329be00f0>(array([[0.0865015 , 0.09433011, 0.01149338],\n       [0.11656271, 0.05122164, 0.06855141],\n       [0.03006122, 0.04310847, 0.08004479]]) < 0.1)
E        +    where <function all at 0x747329be00f0> = np.all
E        +    and   array([[0.0865015 , 0.09433011, 0.01149338],\n       [0.11656271, 0.05122164, 0.06855141],\n       [0.03006122, 0.04310847, 0.08004479]]) = abs((array([[ 1.39268018, -0.03829551, -0.30381108],\n       [-0.16025329,  1.16755967, -0.13735996],\n       [-0.23242689, -0.12926416,  1.44117104]]) - array([[ 1.47918168, -0.13262562, -0.2923177 ],\n       [-0.276816  ,  1.21878131, -0.06880855],\n       [-0.20236568, -0.08615568,  1.36112625]])))

/local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py:453: AssertionError
_____________________ test_estimate_noise_matrices[False] ______________________

sparse = False

    @pytest.mark.parametrize("sparse", [True, False])
    def test_estimate_noise_matrices(sparse):
        data = make_data(sparse=sparse, seed=seed)
        nm, inv = count.estimate_noise_matrices(
            X=data["X_train"],
            labels=data["labels"],
        )
        assert np.all(abs(nm - data["est_nm"]) < 0.1)
>       assert np.all(abs(inv - data["est_inv"]) < 0.1)
E       assert False
E        +  where False = <function all at 0x747329be00f0>(array([[0.0865015 , 0.09433011, 0.01149338],\n       [0.11656271, 0.05122164, 0.06855141],\n       [0.03006122, 0.04310847, 0.08004479]]) < 0.1)
E        +    where <function all at 0x747329be00f0> = np.all
E        +    and   array([[0.0865015 , 0.09433011, 0.01149338],\n       [0.11656271, 0.05122164, 0.06855141],\n       [0.03006122, 0.04310847, 0.08004479]]) = abs((array([[ 1.39268018, -0.03829551, -0.30381108],\n       [-0.16025329,  1.16755967, -0.13735996],\n       [-0.23242689, -0.12926416,  1.44117104]]) - array([[ 1.47918168, -0.13262562, -0.2923177 ],\n       [-0.276816  ,  1.21878131, -0.06880855],\n       [-0.20236568, -0.08615568,  1.36112625]])))

/local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py:453: AssertionError
________________________________ test_issue_158 ________________________________

confident_joint = array([[3, 0, 3, 0],
       [2, 1, 1, 0],
       [3, 0, 3, 0],
       [1, 0, 4, 1]])
labels = array([3, 3, 1, 3, 0, 2, 2, 2, 0, 2, 2, 1, 0, 0, 0, 0, 2, 1, 3, 3])
py_method = 'cnt', converge_latent_estimates = False

    def estimate_latent(confident_joint, labels, py_method='cnt', converge_latent_estimates=False):
        K = confident_joint.shape[0]
        if confident_joint.shape != (K, K):
            raise ValueError('confident_joint must be a square matrix of shape (K, K).')
        if labels.ndim != 1 or not np.issubdtype(labels.dtype, np.integer):
            raise ValueError('labels must be a 1D array of integers.')
        if py_method == 'cnt':
            py = np.diag(confident_joint) / np.sum(confident_joint)
        elif py_method == 'eqn':
            raise NotImplementedError("The 'eqn' method is not implemented yet.")
        elif py_method == 'marginal':
            raise NotImplementedError("The 'marginal' method is not implemented yet.")
        elif py_method == 'marginal_ps':
            raise NotImplementedError("The 'marginal_ps' method is not implemented yet.")
        else:
            raise ValueError(f'Unsupported py_method: {py_method}')
        noise_matrix = confident_joint / np.sum(confident_joint, axis=0, keepdims=True)
        try:
>           inv_noise_matrix = np.linalg.inv(noise_matrix)

/local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/temp.py:34: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/cleanlab/cleanlab/venv/lib/python3.11/site-packages/numpy/linalg/linalg.py:561: in inv
    ainv = _umath_linalg.inv(a, signature=signature, extobj=extobj)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

err = 'invalid value', flag = 8

    def _raise_linalgerror_singular(err, flag):
>       raise LinAlgError("Singular matrix")
E       numpy.linalg.LinAlgError: Singular matrix

/local/data0/moved_data/publishablew/cleanlab/cleanlab/venv/lib/python3.11/site-packages/numpy/linalg/linalg.py:112: LinAlgError

During handling of the above exception, another exception occurred:

    def test_issue_158():
        # ref: https://github.com/cleanlab/cleanlab/issues/158
        pred_probs = np.array(
            [
                [0.27916167, 0.14589103, 0.29264585, 0.28230144],
                [0.13429196, 0.12536383, 0.47943979, 0.26090442],
                [0.41348584, 0.13463275, 0.25845595, 0.19342546],
                [0.27753469, 0.12295569, 0.33125886, 0.26825075],
                [0.11649856, 0.11219034, 0.51857122, 0.25273988],
                [0.38010026, 0.25572261, 0.13305410, 0.23112304],
                [0.31583755, 0.13630690, 0.29246806, 0.25538750],
                [0.30240076, 0.16925207, 0.26499082, 0.26335636],
                [0.44524505, 0.27410085, 0.08305069, 0.19760341],
                [0.22903975, 0.07783631, 0.38035414, 0.31276980],
                [0.25071560, 0.12072900, 0.32551729, 0.30303812],
                [0.43809229, 0.14401381, 0.20839300, 0.20950090],
                [0.20749181, 0.11883556, 0.38402152, 0.28965111],
                [0.43840254, 0.13538447, 0.24518806, 0.18102493],
                [0.28504779, 0.10309750, 0.34258602, 0.26926868],
                [0.38425408, 0.29168969, 0.15181255, 0.17224368],
                [0.19339907, 0.10804265, 0.37570368, 0.32285460],
                [0.21509781, 0.07190167, 0.38914722, 0.32385330],
                [0.27040334, 0.13037840, 0.32842320, 0.27079507],
                [0.40590210, 0.16713560, 0.24889193, 0.17807036],
            ]
        )
        labels = np.array([3, 3, 1, 3, 0, 2, 2, 2, 0, 2, 2, 1, 0, 0, 0, 0, 2, 1, 3, 3])
    
        cj = count.compute_confident_joint(labels, pred_probs, calibrate=False)
        # should be no zeros on the diagonal
        assert np.all(cj.diagonal() != 0)
    
>       py, noise_matrix, inv_noise_matrix = count.estimate_latent(cj, labels)

/local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py:1071: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
/local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/count.py:510: in estimate_latent
    return estimate_latent(confident_joint, labels)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

confident_joint = array([[3, 0, 3, 0],
       [2, 1, 1, 0],
       [3, 0, 3, 0],
       [1, 0, 4, 1]])
labels = array([3, 3, 1, 3, 0, 2, 2, 2, 0, 2, 2, 1, 0, 0, 0, 0, 2, 1, 3, 3])
py_method = 'cnt', converge_latent_estimates = False

    def estimate_latent(confident_joint, labels, py_method='cnt', converge_latent_estimates=False):
        K = confident_joint.shape[0]
        if confident_joint.shape != (K, K):
            raise ValueError('confident_joint must be a square matrix of shape (K, K).')
        if labels.ndim != 1 or not np.issubdtype(labels.dtype, np.integer):
            raise ValueError('labels must be a 1D array of integers.')
        if py_method == 'cnt':
            py = np.diag(confident_joint) / np.sum(confident_joint)
        elif py_method == 'eqn':
            raise NotImplementedError("The 'eqn' method is not implemented yet.")
        elif py_method == 'marginal':
            raise NotImplementedError("The 'marginal' method is not implemented yet.")
        elif py_method == 'marginal_ps':
            raise NotImplementedError("The 'marginal_ps' method is not implemented yet.")
        else:
            raise ValueError(f'Unsupported py_method: {py_method}')
        noise_matrix = confident_joint / np.sum(confident_joint, axis=0, keepdims=True)
        try:
            inv_noise_matrix = np.linalg.inv(noise_matrix)
        except np.linalg.LinAlgError:
>           raise ValueError('Noise matrix is singular and cannot be inverted.')
E           ValueError: Noise matrix is singular and cannot be inverted.

/local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/temp.py:36: ValueError
_____________ test_estimate_py_and_noise_matrices_missing_classes ______________

    def test_estimate_py_and_noise_matrices_missing_classes():
        labels = np.array([0, 0, 2, 2])
        pred_probs = np.array(
            [[0.9, 0.0, 0.1, 0.0], [0.8, 0.0, 0.2, 0.0], [0.1, 0.0, 0.9, 0.0], [0.95, 0.0, 0.05, 0.0]]
        )
        (
            py,
            noise_matrix,
            inverse_noise_matrix,
            confident_joint,
        ) = estimate_py_and_noise_matrices_from_probabilities(labels, pred_probs)
        # check results with pred-prob on missing classes = 0 match results without these missing classes in pred_probs
        present_classes = list(sorted(np.unique(labels)))
        pred_probs2 = pred_probs[:, present_classes]
        labels2 = np.array([0, 0, 1, 1])
        (
            py2,
            noise_matrix2,
            inverse_noise_matrix2,
            confident_joint2,
        ) = estimate_py_and_noise_matrices_from_probabilities(labels2, pred_probs2)
        # These may be slightly off due to clipping to prevent division by 0:
        assert (np.isclose(py[present_classes], py2, atol=1e-5)).all()
        assert (
            np.isclose(confident_joint[np.ix_(present_classes, present_classes)], confident_joint2)
        ).all()
        assert (np.isclose(noise_matrix[np.ix_(present_classes, present_classes)], noise_matrix2)).all()
>       assert (
            np.isclose(
                inverse_noise_matrix[np.ix_(present_classes, present_classes)], inverse_noise_matrix2
            )
        ).all()
E       assert False
E        +  where False = <built-in method all of numpy.ndarray object at 0x747325fa33f0>()
E        +    where <built-in method all of numpy.ndarray object at 0x747325fa33f0> = array([[False, False],\n       [False, False]]).all
E        +      where array([[False, False],\n       [False, False]]) = <function isclose at 0x747329bec3f0>(array([[nan, nan],\n       [nan, nan]]), array([[ 1.5,  0. ],\n       [-0.5,  1. ]]))
E        +        where <function isclose at 0x747329bec3f0> = np.isclose

/local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py:1284: AssertionError
=============================== warnings summary ===============================
tests/test_filter_count.py: 51 warnings
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:304: DeprecationWarning: The multi_label argument to filter.find_label_issues() is deprecated and will be removed in future versions. Please use `multilabel_classification.filter.find_label_issues()` instead.
    warnings.warn(

tests/test_filter_count.py::test_find_label_issue_filters_match_origin_functions
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:247: UserWarning: frac_noise and num_to_remove_per_class parameters are only supported for filter_by 'prune_by_noise_rate', 'prune_by_class', and 'both'. They are not supported for methods 'confident_learning', 'predicted_neq_given', 'low_normalized_margin' or 'low_self_confidence'.
    warnings.warn(warn_str)

tests/test_filter_count.py::test_num_label_issues
tests/test_filter_count.py::test_num_label_issues
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/count.py:82: UserWarning: The supplied `confident_joint` is ignored as `confident_joint` is recomuputed internally using the supplied `labels` and `pred_probs`. If you still want to use custom `confident_joint` call function with `estimation_method='off_diagonal_custom'`.
    warnings.warn(warn_str)

tests/test_filter_count.py::test_num_label_issues
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:268: UserWarning: The supplied `confident_joint` is ignored when `filter_by = 'confident_learning'`; confident joint will be re-estimated from the given labels. To use your supplied `confident_joint`, please specify a different `filter_by` value.
    warnings.warn(warn_str)

tests/test_filter_count.py::test_find_label_issues_match_multiprocessing
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:904: UserWarning: May not flag all label issues in class: 2, it has too few examples (see `min_examples_per_class` argument)
    warnings.warn(

tests/test_filter_count.py::test_find_label_issues_match_multiprocessing
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:904: UserWarning: May not flag all label issues in class: 3, it has too few examples (see `min_examples_per_class` argument)
    warnings.warn(

tests/test_filter_count.py::test_find_label_issues_match_multiprocessing
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:874: UserWarning: May not flag all label issues in class: 2, it has too few examples (see argument: `min_examples_per_class`)
    warnings.warn(

tests/test_filter_count.py::test_find_label_issues_match_multiprocessing
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:874: UserWarning: May not flag all label issues in class: 3, it has too few examples (see argument: `min_examples_per_class`)
    warnings.warn(

tests/test_filter_count.py::test_estimate_py_and_noise_matrices_missing_classes
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/temp.py:32: RuntimeWarning: invalid value encountered in divide
    noise_matrix = confident_joint / np.sum(confident_joint, axis=0, keepdims=True)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED ../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_latent_converge
FAILED ../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_noise_matrices[True]
FAILED ../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_noise_matrices[False]
FAILED ../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_issue_158
FAILED ../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_py_and_noise_matrices_missing_classes
================= 5 failed, 130 passed, 67 warnings in 32.85s ==================


Final Test Result:
============================= test session starts ==============================
platform linux -- Python 3.11.10, pytest-8.3.4, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/cleanlab/cleanlab/venv/bin/python
cachedir: .pytest_cache
hypothesis profile 'default' -> database=DirectoryBasedExampleDatabase(PosixPath('/home/aliredaq/Desktop/ICSE/src/tester/.hypothesis/examples'))
rootdir: /local/data0/moved_data/publishablew/cleanlab/cleanlab
configfile: pyproject.toml
plugins: hypothesis-6.124.1
collecting ... collected 135 items

../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_exact_prune_count PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_both[None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_both[1] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_both[2] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_prune_on_small_data[prune_by_noise_rate] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_prune_on_small_data[prune_by_class] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_prune_on_small_data[both] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_prune_on_small_data[confident_learning] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_prune_on_small_data[predicted_neq_given] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_calibrate_joint PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_calibrate_joint_multilabel PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_joint[True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_joint[False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_joint_multilabel PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confidence_thresholds PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confidence_thresholds_multilabel PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_compute_confident_joint PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_latent_py_method PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_latent_converge PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_noise_matrices[True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_noise_matrices[False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_reduce_prune_counts PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_keep_at_least_n_per_class PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_order_method PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_noise_rate-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_noise_rate-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_noise_rate-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_noise_rate-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_class-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_class-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_class-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_class-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-both-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-both-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-both-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-both-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-confident_learning-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-confident_learning-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-confident_learning-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-confident_learning-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_noise_rate-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_noise_rate-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_noise_rate-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_noise_rate-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_class-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_class-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_class-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_class-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-both-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-both-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-both-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-both-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-confident_learning-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-confident_learning-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-confident_learning-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-confident_learning-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_noise_rate-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_noise_rate-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_noise_rate-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_noise_rate-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_class-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_class-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_class-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_class-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-both-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-both-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-both-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-both-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-confident_learning-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-confident_learning-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-confident_learning-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-confident_learning-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_noise_rate-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_noise_rate-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_noise_rate-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_noise_rate-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_class-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_class-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_class-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_class-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-both-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-both-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-both-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-both-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-confident_learning-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-confident_learning-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-confident_learning-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-confident_learning-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[None-None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[None-confident_joint1] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[None-confident_joint2] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[self_confidence-None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[self_confidence-confident_joint1] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[self_confidence-confident_joint2] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[normalized_margin-None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[normalized_margin-confident_joint1] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[normalized_margin-confident_joint2] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[confidence_weighted_entropy-None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[confidence_weighted_entropy-confident_joint1] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[confidence_weighted_entropy-confident_joint2] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confident_learning_filter[True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confident_learning_filter[False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confident_learning_filter_multilabel[True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confident_learning_filter_multilabel[False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_predicted_neq_given_filter PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_predicted_neq_given_filter_multilabel PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[prune_by_noise_rate-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[prune_by_noise_rate-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[prune_by_class-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[prune_by_class-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[both-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[both-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issue_filters_match_origin_functions Number of label issues found: 1
PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_num_label_issues_different_estimation_types PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_same_value PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_num_label_issues PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_num_label_issues_multilabel[None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_num_label_issues_multilabel[True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_batched_label_issues Total number of examples whose labels have been evaluated: 160
Multiprocessing will default to using the number of logical cores (16). To default to number of physical cores: pip install psutil
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Multiprocessing will default to using the number of logical cores (16). To default to number of physical cores: pip install psutil
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
mmap-loaded numpy arrays have: 160 examples, 3 classes
Total number of examples whose labels have been evaluated: 160
PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_issue_158 PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_missing_classes PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_match_multiprocessing PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_missing_classes_multilabel[None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_missing_classes_multilabel[self_confidence] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_missing_classes_multilabel[normalized_margin] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_missing_classes_multilabel[confidence_weighted_entropy] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_removing_class_consistent_results PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_py_and_noise_matrices_missing_classes PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_low_filter_by_methods PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_low_filter_by_methods_multilabel PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_does_not_flag_correct_examples[prune_by_noise_rate] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_does_not_flag_correct_examples[prune_by_class] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_does_not_flag_correct_examples[both] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_does_not_flag_correct_examples[confident_learning] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_does_not_flag_correct_examples[predicted_neq_given] PASSED

=============================== warnings summary ===============================
tests/test_filter_count.py: 51 warnings
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:304: DeprecationWarning: The multi_label argument to filter.find_label_issues() is deprecated and will be removed in future versions. Please use `multilabel_classification.filter.find_label_issues()` instead.
    warnings.warn(

tests/test_filter_count.py::test_find_label_issue_filters_match_origin_functions
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:247: UserWarning: frac_noise and num_to_remove_per_class parameters are only supported for filter_by 'prune_by_noise_rate', 'prune_by_class', and 'both'. They are not supported for methods 'confident_learning', 'predicted_neq_given', 'low_normalized_margin' or 'low_self_confidence'.
    warnings.warn(warn_str)

tests/test_filter_count.py::test_num_label_issues
tests/test_filter_count.py::test_num_label_issues
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/count.py:132: UserWarning: The supplied `confident_joint` is ignored as `confident_joint` is recomuputed internally using the supplied `labels` and `pred_probs`. If you still want to use custom `confident_joint` call function with `estimation_method='off_diagonal_custom'`.
    warnings.warn(warn_str)

tests/test_filter_count.py::test_num_label_issues
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:268: UserWarning: The supplied `confident_joint` is ignored when `filter_by = 'confident_learning'`; confident joint will be re-estimated from the given labels. To use your supplied `confident_joint`, please specify a different `filter_by` value.
    warnings.warn(warn_str)

tests/test_filter_count.py::test_find_label_issues_match_multiprocessing
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:904: UserWarning: May not flag all label issues in class: 2, it has too few examples (see `min_examples_per_class` argument)
    warnings.warn(

tests/test_filter_count.py::test_find_label_issues_match_multiprocessing
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:904: UserWarning: May not flag all label issues in class: 3, it has too few examples (see `min_examples_per_class` argument)
    warnings.warn(

tests/test_filter_count.py::test_find_label_issues_match_multiprocessing
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:874: UserWarning: May not flag all label issues in class: 2, it has too few examples (see argument: `min_examples_per_class`)
    warnings.warn(

tests/test_filter_count.py::test_find_label_issues_match_multiprocessing
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:874: UserWarning: May not flag all label issues in class: 3, it has too few examples (see argument: `min_examples_per_class`)
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
====================== 135 passed, 66 warnings in 32.52s =======================


Initial Result:
============================= test session starts ==============================
platform linux -- Python 3.11.10, pytest-8.3.4, pluggy-1.5.0 -- /local/data0/moved_data/publishablew/cleanlab/cleanlab/venv/bin/python
cachedir: .pytest_cache
hypothesis profile 'default' -> database=DirectoryBasedExampleDatabase(PosixPath('/home/aliredaq/Desktop/ICSE/src/tester/.hypothesis/examples'))
rootdir: /local/data0/moved_data/publishablew/cleanlab/cleanlab
configfile: pyproject.toml
plugins: hypothesis-6.124.1
collecting ... collected 135 items

../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_exact_prune_count PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_both[None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_both[1] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_both[2] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_prune_on_small_data[prune_by_noise_rate] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_prune_on_small_data[prune_by_class] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_prune_on_small_data[both] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_prune_on_small_data[confident_learning] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_prune_on_small_data[predicted_neq_given] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_calibrate_joint PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_calibrate_joint_multilabel PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_joint[True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_joint[False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_joint_multilabel PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confidence_thresholds PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confidence_thresholds_multilabel PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_compute_confident_joint PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_latent_py_method PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_latent_converge PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_noise_matrices[True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_noise_matrices[False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_reduce_prune_counts PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_keep_at_least_n_per_class PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_pruning_order_method PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_noise_rate-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_noise_rate-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_noise_rate-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_noise_rate-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_class-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_class-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_class-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-prune_by_class-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-both-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-both-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-both-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-both-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-confident_learning-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-confident_learning-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-confident_learning-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[None-confident_learning-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_noise_rate-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_noise_rate-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_noise_rate-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_noise_rate-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_class-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_class-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_class-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-prune_by_class-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-both-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-both-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-both-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-both-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-confident_learning-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-confident_learning-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-confident_learning-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[self_confidence-confident_learning-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_noise_rate-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_noise_rate-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_noise_rate-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_noise_rate-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_class-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_class-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_class-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-prune_by_class-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-both-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-both-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-both-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-both-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-confident_learning-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-confident_learning-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-confident_learning-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[normalized_margin-confident_learning-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_noise_rate-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_noise_rate-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_noise_rate-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_noise_rate-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_class-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_class-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_class-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-prune_by_class-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-both-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-both-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-both-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-both-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-confident_learning-True-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-confident_learning-True-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-confident_learning-False-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label[confidence_weighted_entropy-confident_learning-False-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[None-None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[None-confident_joint1] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[None-confident_joint2] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[self_confidence-None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[self_confidence-confident_joint1] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[self_confidence-confident_joint2] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[normalized_margin-None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[normalized_margin-confident_joint1] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[normalized_margin-confident_joint2] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[confidence_weighted_entropy-None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[confidence_weighted_entropy-confident_joint1] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_multi_label_small[confidence_weighted_entropy-confident_joint2] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confident_learning_filter[True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confident_learning_filter[False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confident_learning_filter_multilabel[True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_confident_learning_filter_multilabel[False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_predicted_neq_given_filter PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_predicted_neq_given_filter_multilabel PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[prune_by_noise_rate-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[prune_by_noise_rate-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[prune_by_class-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[prune_by_class-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[both-True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_using_argmax_confusion_matrix[both-False] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issue_filters_match_origin_functions Number of label issues found: 1
PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_num_label_issues_different_estimation_types PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_same_value PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_num_label_issues PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_num_label_issues_multilabel[None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_num_label_issues_multilabel[True] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_batched_label_issues Total number of examples whose labels have been evaluated: 160
Multiprocessing will default to using the number of logical cores (16). To default to number of physical cores: pip install psutil
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Multiprocessing will default to using the number of logical cores (16). To default to number of physical cores: pip install psutil
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
Total number of examples whose labels have been evaluated: 160
mmap-loaded numpy arrays have: 160 examples, 3 classes
Total number of examples whose labels have been evaluated: 160
PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_issue_158 PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_missing_classes PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_find_label_issues_match_multiprocessing PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_missing_classes_multilabel[None] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_missing_classes_multilabel[self_confidence] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_missing_classes_multilabel[normalized_margin] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_missing_classes_multilabel[confidence_weighted_entropy] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_removing_class_consistent_results PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_estimate_py_and_noise_matrices_missing_classes PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_low_filter_by_methods PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_low_filter_by_methods_multilabel PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_does_not_flag_correct_examples[prune_by_noise_rate] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_does_not_flag_correct_examples[prune_by_class] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_does_not_flag_correct_examples[both] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_does_not_flag_correct_examples[confident_learning] PASSED
../../../../../../local/data0/moved_data/publishablew/cleanlab/cleanlab/tests/test_filter_count.py::test_does_not_flag_correct_examples[predicted_neq_given] PASSED

=============================== warnings summary ===============================
tests/test_filter_count.py: 51 warnings
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:304: DeprecationWarning: The multi_label argument to filter.find_label_issues() is deprecated and will be removed in future versions. Please use `multilabel_classification.filter.find_label_issues()` instead.
    warnings.warn(

tests/test_filter_count.py::test_find_label_issue_filters_match_origin_functions
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:247: UserWarning: frac_noise and num_to_remove_per_class parameters are only supported for filter_by 'prune_by_noise_rate', 'prune_by_class', and 'both'. They are not supported for methods 'confident_learning', 'predicted_neq_given', 'low_normalized_margin' or 'low_self_confidence'.
    warnings.warn(warn_str)

tests/test_filter_count.py::test_num_label_issues
tests/test_filter_count.py::test_num_label_issues
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/count.py:132: UserWarning: The supplied `confident_joint` is ignored as `confident_joint` is recomuputed internally using the supplied `labels` and `pred_probs`. If you still want to use custom `confident_joint` call function with `estimation_method='off_diagonal_custom'`.
    warnings.warn(warn_str)

tests/test_filter_count.py::test_num_label_issues
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
tests/test_filter_count.py::test_num_label_issues_multilabel[True]
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:268: UserWarning: The supplied `confident_joint` is ignored when `filter_by = 'confident_learning'`; confident joint will be re-estimated from the given labels. To use your supplied `confident_joint`, please specify a different `filter_by` value.
    warnings.warn(warn_str)

tests/test_filter_count.py::test_find_label_issues_match_multiprocessing
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:904: UserWarning: May not flag all label issues in class: 2, it has too few examples (see `min_examples_per_class` argument)
    warnings.warn(

tests/test_filter_count.py::test_find_label_issues_match_multiprocessing
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:904: UserWarning: May not flag all label issues in class: 3, it has too few examples (see `min_examples_per_class` argument)
    warnings.warn(

tests/test_filter_count.py::test_find_label_issues_match_multiprocessing
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:874: UserWarning: May not flag all label issues in class: 2, it has too few examples (see argument: `min_examples_per_class`)
    warnings.warn(

tests/test_filter_count.py::test_find_label_issues_match_multiprocessing
  /local/data0/moved_data/publishablew/cleanlab/cleanlab/cleanlab/filter.py:874: UserWarning: May not flag all label issues in class: 3, it has too few examples (see argument: `min_examples_per_class`)
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
====================== 135 passed, 66 warnings in 33.80s =======================
