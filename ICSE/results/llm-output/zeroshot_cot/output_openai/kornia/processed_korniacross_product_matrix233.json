{
    "result": "To create the `cross_product_matrix` function, we need to construct a skew-symmetric matrix for each vector in the input tensor. A skew-symmetric matrix for a vector \\([a, b, c]\\) is given by:\n\n\\[\n\\begin{bmatrix}\n0 & -c & b \\\\\nc & 0 & -a \\\\\n-b & a & 0\n\\end{bmatrix}\n\\]\n\nHere's how we can implement this in Python using PyTorch:\n\n1. **Check the Input Shape**: Ensure the last dimension of the input tensor is 3. If not, raise an `AssertionError`.\n\n2. **Construct the Cross-Product Matrix**: For each vector in the input tensor, construct the corresponding skew-symmetric matrix.\n\n3. **Return the Result**: Return a tensor containing all the constructed matrices.\n\nLet's implement this step by step:\n\n```python\nimport torch\n\ndef cross_product_matrix(x: torch.Tensor) -> torch.Tensor:\n    # Step 1: Check the input shape\n    if not x.shape[-1] == 3:\n        raise AssertionError(f\"Expected last dimension to be 3, but got {x.shape[-1]}\")\n    \n    # Step 2: Extract components of the vector\n    a = x[..., 0]\n    b = x[..., 1]\n    c = x[..., 2]\n    \n    # Step 3: Construct the skew-symmetric matrix\n    zero = torch.zeros_like(a)\n    cross_prod_matrices = torch.stack([\n        torch.stack([zero, -c, b], dim=-1),\n        torch.stack([c, zero, -a], dim=-1),\n        torch.stack([-b, a, zero], dim=-1)\n    ], dim=-2)\n    \n    # Step 4: Return the result\n    return cross_prod_matrices\n\n# Example usage:\n# x = torch.tensor([[1.0, 2.0, 3.0], [4.0, 5.0, 6.0]])\n# result = cross_product_matrix(x)\n# print(result)\n```\n\n### Explanation:\n\n- **Input Check**: We first check if the last dimension of the input tensor is 3. If not, an `AssertionError` is raised with a descriptive message.\n\n- **Component Extraction**: We extract the components \\(a\\), \\(b\\), and \\(c\\) from the input tensor using advanced indexing.\n\n- **Matrix Construction**: We construct the skew-symmetric matrix using `torch.stack`. We create three rows of the matrix and stack them along a new dimension to form the 3x3 matrix.\n\n- **Return**: The function returns a tensor of shape `(*, 3, 3)`, where `*` represents any leading dimensions of the input tensor.\n\nThis function can handle multiple vectors at once, thanks to the use of broadcasting and advanced indexing in PyTorch.",
    "prompt": "Create a Python function `cross_product_matrix` that:\n\n- Constructs the cross-product matrix (a skew-symmetric matrix) for a given vector.\n- Accepts a single parameter:\n  - `x`: A tensor of shape `(*, 3)` representing the input vector(s).\n- Returns a tensor containing the constructed cross-product matrix with shape `(*, 3, 3)`.\n\nErrors:\n- Raises an `AssertionError` if the last dimension of the input tensor is not equal to 3.\ndef cross_product_matrix(x: torch.Tensor) -> torch.Tensor:\n      if not x.shape[-1] == 3:\n        raise AssertionError(x.shape)\n## complete",
    "function_name": "cross_product_matrix",
    "ground_truth": "kornia/geometry/epipolar/numeric.py#L8",
    "test": "tests/geometry/epipolar/test_numeric.py::TestSkewSymmetric",
    "class": "",
    "stage": "Model Construction",
    "task": "",
    "data": "Image"
}