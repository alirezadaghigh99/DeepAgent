{
    "result": "Here's a Python function `labels_to_array` that meets the specified requirements:\n\n```python\nimport numpy as np\nimport pandas as pd\nfrom typing import Union\n\nLabelLike = Union[list, np.ndarray, pd.Series, pd.DataFrame]\n\ndef labels_to_array(y: LabelLike) -> np.ndarray:\n    \"\"\"\n    Converts various label types into a 1D NumPy array.\n\n    Args:\n        y (LabelLike): Labels to be converted, which can be a list, numpy array, pandas Series, or pandas DataFrame.\n\n    Returns:\n        np.ndarray: A 1D NumPy array of labels.\n\n    Raises:\n        ValueError: If the input is a DataFrame with more than one column or if the conversion to a 1D NumPy array fails.\n    \"\"\"\n    if isinstance(y, pd.DataFrame):\n        if y.shape[1] != 1:\n            raise ValueError(\"DataFrame input must have exactly one column.\")\n        y = y.iloc[:, 0]  # Convert single-column DataFrame to Series\n\n    if isinstance(y, (list, pd.Series)):\n        y = np.array(y)\n\n    if isinstance(y, np.ndarray):\n        if y.ndim != 1:\n            raise ValueError(\"Input cannot be converted to a 1D NumPy array.\")\n        return y\n\n    raise ValueError(\"Input type not supported for conversion to a 1D NumPy array.\")\n```\n\n### Explanation:\n- **Input Handling**: The function accepts `y` which can be a list, numpy array, pandas Series, or pandas DataFrame.\n- **DataFrame Handling**: If `y` is a DataFrame, it checks if it has exactly one column. If not, it raises a `ValueError`.\n- **Conversion**: It converts lists and pandas Series to numpy arrays. If `y` is already a numpy array, it checks if it is 1D.\n- **Error Handling**: Raises a `ValueError` if the input cannot be converted to a 1D numpy array or if the input type is unsupported.",
    "prompt": "Create a Python function `labels_to_array` that converts various label types into a 1D NumPy array. The function should:\n- Accept `y` as input, which can be a list, numpy array, pandas Series, or pandas DataFrame.\n- Convert the input `y` to a 1D NumPy array and return it.\n- Raise a `ValueError` if the input is a DataFrame with more than one column or if the input cannot be converted to a 1D NumPy array.\n\nInput types:\n- `y`: Union[LabelLike, np.generic] - labels to be converted.\n\nOutput:\n- Returns a 1D NumPy array of labels.\n\nErrors:\n- Raise a `ValueError` if the input is a DataFrame with more than one column or if the conversion to a 1D NumPy array fails.",
    "function_name": "labels_to_array",
    "ground_truth": "cleanlab/internal/validation.py",
    "test": "tests/test_validation.py::test_labels_to_array_return_values",
    "class": "",
    "stage": "Pre-Post processing",
    "task": "Classification",
    "data": "Table"
}